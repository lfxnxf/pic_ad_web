{"remainingRequest":"/Users/zhang/canteen_manage/node_modules/babel-loader/lib/index.js!/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhang/canteen_manage/src/views/businessinfo/restaurant-staff/components/editmodal.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhang/canteen_manage/src/views/businessinfo/restaurant-staff/components/editmodal.vue","mtime":1639539672008},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IF8gZnJvbSAndW5kZXJzY29yZSc7CmltcG9ydCB7IHJzYUVuY3J5cHRCeVB1YktleSB9IGZyb20gIkAvbGlicy91dGlsIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBidG5Mb2FkaW5nOiBmYWxzZSwKICAgICAgZm9ybTogewogICAgICAgIG5hbWU6ICcnLAogICAgICAgIHBob25lOiAnJywKICAgICAgICBwYXNzd29yZDogJycsCiAgICAgICAgbmV3X3Bhc3N3b3JkOiAnJywKICAgICAgICB1c2VybmFtZTogJycsCiAgICAgICAgaXNfZW5hYmxlOiBudWxsCiAgICAgIH0sCiAgICAgIHJ1bGVGb3JtOiB7CiAgICAgICAgbmFtZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeWRmOW3peWnk+WQjScsCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICB9XSwKICAgICAgICBwaG9uZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeaJi+acuuWPtycsCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICB9XQogICAgICB9LAogICAgICBwd2RTaG93OiBmYWxzZQogICAgfTsKICB9LAogIGNvbXBvbmVudHM6IHt9LAogIGNvbXB1dGVkOiB7CiAgICBjdXJNZXJjaGFudFVzZXI6IGZ1bmN0aW9uIGN1ck1lcmNoYW50VXNlcigpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLm1lcmNoYW50LmN1ck1lcmNoYW50VXNlcjsKICAgIH0sCiAgICBlZGl0c3RhZmZNb2RhbDogewogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUubWVyY2hhbnQuZWRpdE1lcmNoYW50VXNlck1vZGFsOwogICAgICB9LAogICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWwpIHsKICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldEVkaXRNZXJjaGFudFVzZXJNb2RhbCcsIHZhbCk7CiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGVkaXRVc2VyOiBmdW5jdGlvbiBlZGl0VXNlcigpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMuJHJlZnMuZWRpdHN0YWZmRm9ybS52YWxpZGF0ZShmdW5jdGlvbiAodmFsaWQpIHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIF90aGlzLmJ0bkxvYWRpbmcgPSB0cnVlOwogICAgICAgICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICAgICAgbWVyY2hhbnRfaWQ6IF90aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmN1ck1lcmNoYW50SWQsCiAgICAgICAgICAgIHVzZXJfaWQ6IF90aGlzLmN1ck1lcmNoYW50VXNlci51c2VyX2lkLAogICAgICAgICAgICBuYW1lOiBfdGhpcy5mb3JtLm5hbWUsCiAgICAgICAgICAgIHBob25lOiBfdGhpcy5mb3JtLnBob25lLAogICAgICAgICAgICBpc19lbmFibGU6IF90aGlzLmZvcm0uaXNfZW5hYmxlID8gMSA6IDAKICAgICAgICAgIH07CgogICAgICAgICAgaWYgKF90aGlzLnB3ZFNob3cpIHsKICAgICAgICAgICAgdmFyIHB3ZCA9IF90aGlzLmZvcm0ubmV3X3Bhc3N3b3JkLnRyaW0oKTsKCiAgICAgICAgICAgIGlmIChwd2QubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICBfdGhpcy4kTWVzc2FnZS5lcnJvcigi6K+36L6T5YWl5paw5a+G56CB77yBIik7CgogICAgICAgICAgICAgIF90aGlzLmJ0bkxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcGFyYW1zLnBhc3N3b3JkID0gcnNhRW5jcnlwdEJ5UHViS2V5KF90aGlzLmZvcm0ubmV3X3Bhc3N3b3JkLnRyaW0oKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICA7CgogICAgICAgICAgX3RoaXMuJHN0b3JlLmRpc3BhdGNoKCdtZXJjaGFudFVzZXJFZGl0JywgcGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgaWYgKHJlcy5yZXR1cm5fY29kZSA9PSAwKSB7CiAgICAgICAgICAgICAgX3RoaXMuYnRuTG9hZGluZyA9IGZhbHNlOwoKICAgICAgICAgICAgICBfdGhpcy4kTWVzc2FnZS5zdWNjZXNzKCfkv67mlLnmlLbpk7bnq6/nrqHnkIbotKblj7fmiJDlip/vvIEnKTsKCiAgICAgICAgICAgICAgdmFyIGFyZyA9IHsKICAgICAgICAgICAgICAgIG1lcmNoYW50X2lkOiBfdGhpcy4kc3RvcmUuc3RhdGUudXNlci5jdXJNZXJjaGFudElkLAogICAgICAgICAgICAgICAgcGFnZTogMSwKICAgICAgICAgICAgICAgIHBhZ2Vfc2l6ZTogNTAKICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICBfdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21lcmNoYW50VXNlckxpc3QnLCBhcmcpOwoKICAgICAgICAgICAgICBfdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRFZGl0TWVyY2hhbnRVc2VyTW9kYWwnLCBmYWxzZSk7CgogICAgICAgICAgICAgIF90aGlzLiRyZWZzLmVkaXRzdGFmZkZvcm0ucmVzZXRGaWVsZHMoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICByZXNldFB3ZDogZnVuY3Rpb24gcmVzZXRQd2QoKSB7CiAgICAgIHRoaXMucHdkU2hvdyA9ICF0aGlzLnB3ZFNob3c7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgZWRpdHN0YWZmTW9kYWw6IGZ1bmN0aW9uIGVkaXRzdGFmZk1vZGFsKHZhbCkgewogICAgICBpZiAodmFsKSB7CiAgICAgICAgdGhpcy5mb3JtID0gdGhpcy5jdXJNZXJjaGFudFVzZXI7CiAgICAgICAgdGhpcy5mb3JtLnBhc3N3b3JkID0gJzExMTExMSc7CiAgICAgICAgdGhpcy5mb3JtLm5ld19wYXNzd29yZCA9ICcnOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJlZnMuZWRpdHN0YWZmRm9ybS5yZXNldEZpZWxkcygpOwogICAgICAgIHRoaXMucHdkU2hvdyA9IGZhbHNlOwogICAgICAgIHRoaXMuYnRuTG9hZGluZyA9IGZhbHNlOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["editmodal.vue"],"names":[],"mappings":"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","sourcesContent":["<!--  -->\n<template>\n  <Modal \n    class=\"staff_modal\" \n    v-model=\"editstaffModal\"\n    title=\"编辑收银端管理账号\"\n    :footer-hide=\"true\" \n    width=\"500\">\n    <Form class=\"clearfix\" :model=\"form\" ref=\"editstaffForm\" :rules=\"ruleForm\" :label-width=\"90\">\n      <FormItem label=\"员工姓名\" prop=\"name\">\n        <Input v-model=\"form.name\" style=\"width: 200px\" placeholder=\"请输入员工姓名\" />\n      </FormItem>\n      <FormItem label=\"手机号\" prop=\"phone\">\n        <Input v-model=\"form.phone\" style=\"width: 200px\" placeholder=\"请输入手机号\" />\n      </FormItem>\n      <FormItem label=\"登录名\" prop=\"username\">\n        <Input v-model=\"form.username\" :disabled=\"true\" style=\"width: 200px\" placeholder=\"请输入登录名\" />\n      </FormItem>\n     \n      <FormItem label=\"登录密码\">\n        <Input v-show=\"pwdShow\" v-model=\"form.new_password\" style=\"width: 200px\" placeholder=\"请输入新密码\" /> \n        <Input v-show=\"!pwdShow\" type=\"password\" disabled v-model=\"form.password\" style=\"width: 200px\" /> \n        <Button type=\"primary\" style=\"margin-left:15px;\" @click=\"resetPwd()\">{{pwdShow?'取消重置':'重置密码'}}</Button>\n\n      </FormItem>\n    \n      <FormItem label=\"状态\" class=\"line clearfix margin-bottom-30\">\n        <i-switch size=\"large\" v-model=\"form.is_enable\" :true-value=\"1\" :false-value=\"0\">\n          <span slot=\"open\">启用</span>\n          <span slot=\"close\">禁用</span>\n        </i-switch>\n      </FormItem>\n      <div class=\"text-center\">\n        <Button type=\"success\" style=\"width: 180px;\" :loading='btnLoading' @click=\"editUser()\">确认修改</Button>\n      </div>\n    </Form>\n  </Modal>\n</template>\n\n<script>\nimport _ from 'underscore';\nimport {rsaEncryptByPubKey} from \"@/libs/util\";\nexport default {\n  data () {\n    return {\n      btnLoading: false,\n      form: {\n        name: '',\n        phone: '',\n        password: '',\n        new_password: '',\n        username: '',\n        is_enable: null\n      },\n      ruleForm: {\n        name: [\n          { required: true, message: '请输入员工姓名', trigger: 'blur' }\n        ],\n        phone: [\n          { required: true, message: '请输入手机号', trigger: 'blur' }\n        ],\n      },\n      pwdShow: false,\n    \n    };\n  },\n\n  components: {},\n\n  computed: {\n    curMerchantUser(){\n      return this.$store.state.merchant.curMerchantUser;\n    },\n    editstaffModal:{\n      get(){\n        return this.$store.state.merchant.editMerchantUserModal;\n      },\n      set(val){\n        this.$store.commit('setEditMerchantUserModal', val)\n      }\n    }\n  },\n\n  methods: {\n    editUser(){\n     \n      this.$refs.editstaffForm.validate((valid) => {\n        if (valid) {\n          this.btnLoading = true;\n          let params = {\n            merchant_id: this.$store.state.user.curMerchantId,\n            user_id: this.curMerchantUser.user_id,\n            name: this.form.name,\n            phone: this.form.phone,\n            is_enable: this.form.is_enable?1:0,\n          }\n         \n          if (this.pwdShow){\n            let pwd = this.form.new_password.trim();\n            if (pwd.length == 0){\n              this.$Message.error(\"请输入新密码！\");\n              this.btnLoading = false;\n              return;\n            }\n            else{\n              params.password = rsaEncryptByPubKey(this.form.new_password.trim());\n            }\n          };\n          this.$store.dispatch('merchantUserEdit', params).then(res => {\n            if (res.return_code == 0) {\n              this.btnLoading = false;\n              this.$Message.success('修改收银端管理账号成功！');\n              let arg = {\n                merchant_id: this.$store.state.user.curMerchantId,\n                page: 1,\n                page_size: 50\n              };\n              this.$store.dispatch('merchantUserList', arg);\n              this.$store.commit('setEditMerchantUserModal', false);\n              this.$refs.editstaffForm.resetFields();\n            }\n          }).catch(err=>{\n            \n            console.log(err);\n          });\n        }\n      });\n    },\n    \n    resetPwd(){\n      this.pwdShow = !this.pwdShow;\n   \n    }\n  },\n  watch:{\n   \n    editstaffModal(val){\n      if(val){\n        this.form = this.curMerchantUser;\n        this.form.password = '111111';\n        this.form.new_password = '';\n      }else{\n        this.$refs.editstaffForm.resetFields();\n        this.pwdShow = false;\n        this.btnLoading = false;\n      }\n    }\n  },\n}\n\n</script>\n<style lang='less' scoped>\n@import '../style.css';\n\n</style>"],"sourceRoot":"src/views/businessinfo/restaurant-staff/components"}]}