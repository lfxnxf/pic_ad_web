{"remainingRequest":"/Users/zhang/工作/pic_ad/node_modules/babel-loader/lib/index.js!/Users/zhang/工作/pic_ad/src/libs/platform.js","dependencies":[{"path":"/Users/zhang/工作/pic_ad/src/libs/platform.js","mtime":1646816807875},{"path":"/Users/zhang/工作/pic_ad/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/工作/pic_ad/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMvemhhbmcvXHU1REU1XHU0RjVDL3BpY19hZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9Vc2Vycy96aGFuZy9cdTVERTVcdTRGNUMvcGljX2FkL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnBhcnNlLWludC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmRhdGUudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCBxcyBmcm9tICdxcyc7CmltcG9ydCBzdG9yZSBmcm9tICdAL3N0b3JlJzsKaW1wb3J0IHNpZ24gZnJvbSAnQC9saWJzL3NpZ24nOwppbXBvcnQgZGV2aWNlIGZyb20gJ0AvbGlicy9kZXZpY2UnOwppbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSAndmlldy1kZXNpZ24nOwppbXBvcnQgeyBoYXNPbmVPZiB9IGZyb20gJy4vdG9vbHMnOwppbXBvcnQgY29uZmlnIGZyb20gJ0AvY29uZmlnJzsKLyoqCiAgICAqIOe7hOijheWFrOWFseWPguaVsAogICAgKiBAcGFyYW0ge1N0cmluZ30gcGFyYW1zIOaOpeWPo+WNleeLrOivt+axguWPguaVsAogICAgKi8KCmZ1bmN0aW9uIGJ1aWxkUGFyYW1zKCkgewogIHZhciBwYXJhbXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwogIC8vIOWFrOWFseWPguaVsAogIHZhciBjb21tb25QYXJhbXMgPSB7CiAgICAvLyBhcHBrZXk6IGNvbmZpZy5WVUVfQVBQX1BMQVRGT1JNX0FQUF9LRVksCiAgICAvLyBjaGFubmVsX2lkOiBjb25maWcuVlVFX0FQUF9QTEFURk9STV9BUFBfQ0hBTk5FTF9JRCwKICAgIGFwcGtleTogcHJvY2Vzcy5lbnYuVlVFX0FQUF9QTEFURk9STV9BUFBfS0VZLAogICAgY2hhbm5lbF9pZDogcHJvY2Vzcy5lbnYuVlVFX0FQUF9QTEFURk9STV9BUFBfQ0hBTk5FTF9JRCwKICAgIGFwaV92ZXJzaW9uOiAnMScsCiAgICB0aW1lc3RhbXA6IHBhcnNlSW50KG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCksCiAgICB1YTogJ3BjJywKICAgIGRldmljZWlkOiAncGMnLAogICAgY2xpZW50OiAncGMnLAogICAgcHJvZHVjdF9jb2RlOiAnMzExOScsCiAgICBub25jZTogTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDE1KQogIH07IC8vIOWQiOW5tuWPguaVsAoKICB2YXIgYnVpbGRQYXJhbXMgPSBPYmplY3QuYXNzaWduKGNvbW1vblBhcmFtcywgcGFyYW1zKTsKICBPYmplY3Qua2V5cyhidWlsZFBhcmFtcykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICBpZiAoYnVpbGRQYXJhbXNba2V5XSA9PT0gbnVsbCB8fCBidWlsZFBhcmFtc1trZXldID09PSB1bmRlZmluZWQgfHwgYnVpbGRQYXJhbXNba2V5XSA9PT0gJycpIHsKICAgICAgZGVsZXRlIGJ1aWxkUGFyYW1zW2tleV07CiAgICB9CiAgfSk7IC8vIOetvuWQjQogIC8vIGJ1aWxkUGFyYW1zLnNpZ24gPSBzaWduKGJ1aWxkUGFyYW1zLCBjb25maWcuYXBpVXJsLCBjb25maWcuVlVFX0FQUF9QTEFURk9STV9BUFBfU0VDUkVUKQoKICBidWlsZFBhcmFtcy5zaWduID0gc2lnbihidWlsZFBhcmFtcywgcHJvY2Vzcy5lbnYuVlVFX0FQUF9QTEFURk9STV9BUEksIHByb2Nlc3MuZW52LlZVRV9BUFBfUExBVEZPUk1fQVBQX1NFQ1JFVCk7CiAgcmV0dXJuIGJ1aWxkUGFyYW1zOwp9IC8vIGNvbnN0IGFkZEVycm9yTG9nID0gZXJyb3JJbmZvID0+IHsKLy8gICBjb25zdCB7IHN0YXR1c1RleHQsIHN0YXR1cywgcmVxdWVzdDogeyByZXNwb25zZVVSTCB9IH0gPSBlcnJvckluZm8KLy8gICBjb25zdCBpbmZvID0gewovLyAgICAgdHlwZTogJ2FqYXgnLAovLyAgICAgY29kZTogc3RhdHVzLAovLyAgICAgbWVzOiBzdGF0dXNUZXh0LAovLyAgICAgdXJsOiByZXNwb25zZVVSTAovLyAgIH0KLy8gICBpZiAoIXJlc3BvbnNlVVJMLmluY2x1ZGVzKCdzYXZlX2Vycm9yX2xvZ2dlcicpKSBzdG9yZS5kaXNwYXRjaCgnYWRkRXJyb3JMb2cnLCBpbmZvKQovLyB9CgoKdmFyIFBsYXRmb3JtQXBpcyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gUGxhdGZvcm1BcGlzKGJhc2VVcmwpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQbGF0Zm9ybUFwaXMpOwoKICAgIHRoaXMuYmFzZVVybCA9IGJhc2VVcmw7CiAgICB0aGlzLnF1ZXVlID0ge307CiAgfQoKICBfY3JlYXRlQ2xhc3MoUGxhdGZvcm1BcGlzLCBbewogICAga2V5OiAiZ2V0SW5zaWRlQ29uZmlnIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRJbnNpZGVDb25maWcoKSB7CiAgICAgIHZhciBjb25maWcgPSB7CiAgICAgICAgYmFzZVVSTDogdGhpcy5iYXNlVXJsLAogICAgICAgIGhlYWRlcnM6IHt9CiAgICAgIH07CiAgICAgIHJldHVybiBjb25maWc7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVzdHJveSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSh1cmwpIHsKICAgICAgZGVsZXRlIHRoaXMucXVldWVbdXJsXTsgLy8gaWYgKCFPYmplY3Qua2V5cyh0aGlzLnF1ZXVlKS5sZW5ndGgpIHsKICAgICAgLy8gICBTcGluLmhpZGUoKQogICAgICAvLyB9CiAgICB9CiAgfSwgewogICAga2V5OiAiaW50ZXJjZXB0b3JzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnRlcmNlcHRvcnMoaW5zdGFuY2UsIHVybCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy8g6K+35rGC5oum5oiqCiAgICAgIGluc3RhbmNlLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShmdW5jdGlvbiAoY29uZmlnKSB7CiAgICAgICAgLy8g5re75Yqg5YWo5bGA55qEbG9hZGluZy4uLgogICAgICAgIC8vIGlmICghT2JqZWN0LmtleXModGhpcy5xdWV1ZSkubGVuZ3RoKSB7CiAgICAgICAgLy8gICBTcGluLnNob3coKSAvLyDkuI3lu7rorq7lvIDlkK/vvIzlm6DkuLrnlYzpnaLkuI3lj4vlpb0KICAgICAgICAvLyB9CiAgICAgICAgX3RoaXMucXVldWVbdXJsXSA9IHRydWU7IC8vIGNvbnN0IHRva2VuID0gc3RvcmUuc3RhdGUucGxhdGZvcm0uc2Vzc2lvbmlkCiAgICAgICAgLy8gaWYgKCFoYXNPbmVPZihjb25maWcuZGF0YS5tZXRob2Quc3BsaXQoJy4nKSwgWydsb2dpbicsJ3JlZ2lzdGVyJ10pKSB7CiAgICAgICAgLy8gICBpZiAoIWNvbmZpZy5wYXJhbXMpIHsKICAgICAgICAvLyAgICAgY29uZmlnLnBhcmFtcyA9IHt9CiAgICAgICAgLy8gICB9CiAgICAgICAgLy8gICBpZiAodG9rZW4pIHsKICAgICAgICAvLyAgICAgY29uZmlnLnBhcmFtcy5zZXNzaW9uaWQgPSB0b2tlbgogICAgICAgIC8vICAgfQogICAgICAgIC8vIH0KICAgICAgICAvLyAvLyB0b2tlbiAmJiAoY29uZmlnLmhlYWRlcnMuc2Vzc2lvbmlkID0gdG9rZW4pCgogICAgICAgIHZhciBkYXRhID0gY29uZmlnLmRhdGE7IC8vIHJlbW92ZWQgdGhlIGhhcmRjb3JlIGNvZGUgd2hlbiBkZXBsb3kgdG8gcHJvZAogICAgICAgIC8vIGlmIChkYXRhLm1ldGhvZC5pbmNsdWRlcygnLm1lcmNoYW50LicpICYmICFoYXNLZXkoZGF0YSwgJ3N0b3JlX2lkJykpIGRhdGEuc3RvcmVfaWQgPSBwcm9jZXNzLmVudi5WVUVfQVBQX1NUT1JFX0lECgogICAgICAgIGRhdGEgJiYgKGNvbmZpZy5kYXRhID0gcXMuc3RyaW5naWZ5KGJ1aWxkUGFyYW1zKGRhdGEpKSk7CiAgICAgICAgcmV0dXJuIGNvbmZpZzsKICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKICAgICAgfSk7IC8vIOWTjeW6lOaLpuaIqgoKICAgICAgaW5zdGFuY2UuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMuZGVzdHJveSh1cmwpOyAvLyByZXMuZGF0YeaVsOaNrumDqOWIhuagvOW8j+S4uu+8mnsgZGF0YTogLi4uLCByZXR1cm5fY29kZTogLi4uLCByZXR1cm5fbWVzc2FnZTogLi4ufQoKCiAgICAgICAgdmFyIF9yZXMkZGF0YSA9IHJlcy5kYXRhLAogICAgICAgICAgICBkYXRhID0gX3JlcyRkYXRhLmRhdGEsCiAgICAgICAgICAgIHJldHVybl9jb2RlID0gX3JlcyRkYXRhLnJldHVybl9jb2RlLAogICAgICAgICAgICByZXR1cm5fbWVzc2FnZSA9IF9yZXMkZGF0YS5yZXR1cm5fbWVzc2FnZTsKCiAgICAgICAgaWYgKHJldHVybl9jb2RlID09PSAwKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgICAgICByZXR1cm5fY29kZTogcmV0dXJuX2NvZGUsCiAgICAgICAgICAgIHJldHVybl9tZXNzYWdlOiByZXR1cm5fbWVzc2FnZQogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gY29uc3QgeyByZXF1ZXN0OiB7IHN0YXR1c1RleHQsIHN0YXR1cyB9LCBjb25maWcgfSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZXJyb3IpKQogICAgICAgICAgLy8gY29uc3QgZXJyb3JJbmZvID0gewogICAgICAgICAgLy8gICBzdGF0dXNUZXh0OiByZXR1cm5fbWVzc2FnZSwKICAgICAgICAgIC8vICAgc3RhdHVzOiByZXR1cm5fY29kZSwKICAgICAgICAgIC8vICAgcmVxdWVzdDogeyByZXNwb25zZVVSTDogYFthcGnigKJwbGF0Zm9ybV0ke3VybH1gIH0KICAgICAgICAgIC8vIH0KICAgICAgICAgIC8vIGFkZEVycm9yTG9nKGVycm9ySW5mbykKICAgICAgICAgIE1lc3NhZ2UuZXJyb3IoewogICAgICAgICAgICBjb250ZW50OiByZXR1cm5fbWVzc2FnZSwKICAgICAgICAgICAgY2xvc2FibGU6IHRydWUsCiAgICAgICAgICAgIGR1cmF0aW9uOiA1CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXMuZGF0YSk7CiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZyhlcnJvcikKICAgICAgICAvLyBjb25zb2xlLmxvZyhlcnJvci5yZXNwb25zZSkKICAgICAgICBfdGhpcy5kZXN0cm95KHVybCk7IC8vIGxldCBlcnJvckluZm8gPSBlcnJvci5yZXNwb25zZQogICAgICAgIC8vIGlmICghZXJyb3JJbmZvKSB7CiAgICAgICAgLy8gICBjb25zdCB7IHJlcXVlc3Q6IHsgc3RhdHVzVGV4dCwgc3RhdHVzIH0sIGNvbmZpZyB9ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShlcnJvcikpCiAgICAgICAgLy8gICBlcnJvckluZm8gPSB7CiAgICAgICAgLy8gICAgIHN0YXR1c1RleHQsCiAgICAgICAgLy8gICAgIHN0YXR1cywKICAgICAgICAvLyAgICAgcmVxdWVzdDogeyByZXNwb25zZVVSTDogY29uZmlnLnVybCB9CiAgICAgICAgLy8gICB9CiAgICAgICAgLy8gfQogICAgICAgIC8vIGFkZEVycm9yTG9nKGVycm9ySW5mbykKCgogICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlcXVlc3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlcXVlc3Qob3B0aW9ucykgewogICAgICB2YXIgaW5zdGFuY2UgPSBheGlvcy5jcmVhdGUoKTsKICAgICAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24odGhpcy5nZXRJbnNpZGVDb25maWcoKSwgb3B0aW9ucyk7CiAgICAgIHRoaXMuaW50ZXJjZXB0b3JzKGluc3RhbmNlLCBvcHRpb25zLnVybCk7CiAgICAgIHJldHVybiBpbnN0YW5jZShvcHRpb25zKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBQbGF0Zm9ybUFwaXM7Cn0oKTsKCmV4cG9ydCBkZWZhdWx0IFBsYXRmb3JtQXBpczs="},{"version":3,"sources":["/Users/zhang/工作/pic_ad/src/libs/platform.js"],"names":["axios","qs","store","sign","device","Message","hasOneOf","config","buildParams","params","commonParams","appkey","process","env","VUE_APP_PLATFORM_APP_KEY","channel_id","VUE_APP_PLATFORM_APP_CHANNEL_ID","api_version","timestamp","parseInt","Date","getTime","ua","deviceid","client","product_code","nonce","Math","random","toString","substr","Object","assign","keys","forEach","key","undefined","VUE_APP_PLATFORM_API","VUE_APP_PLATFORM_APP_SECRET","PlatformApis","baseUrl","queue","baseURL","headers","url","instance","interceptors","request","use","data","stringify","error","Promise","reject","response","res","destroy","return_code","return_message","content","closable","duration","options","create","getInsideConfig"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport qs from 'qs'\nimport store from '@/store'\nimport sign from '@/libs/sign'\nimport device from '@/libs/device'\nimport { Message } from 'view-design'\nimport { hasOneOf } from './tools'\nimport config from '@/config'\n\n/**\n    * 组装公共参数\n    * @param {String} params 接口单独请求参数\n    */\nfunction buildParams (params = {}) {\n  // 公共参数\n  const commonParams = {\n    // appkey: config.VUE_APP_PLATFORM_APP_KEY,\n    // channel_id: config.VUE_APP_PLATFORM_APP_CHANNEL_ID,\n    appkey: process.env.VUE_APP_PLATFORM_APP_KEY,\n    channel_id: process.env.VUE_APP_PLATFORM_APP_CHANNEL_ID,\n    api_version: '1',\n    timestamp: parseInt(new Date().getTime() / 1000),\n    ua: 'pc',\n    deviceid: 'pc',\n    client: 'pc',\n    product_code: '3119',\n    nonce: Math.random().toString(36).substr(2, 15)\n  }\n  // 合并参数\n  const buildParams = Object.assign(commonParams, params)\n  Object.keys(buildParams).forEach((key) => {\n    if (buildParams[key] === null || buildParams[key] === undefined || buildParams[key]==='') {\n      delete buildParams[key]\n    }\n  })\n  // 签名\n  // buildParams.sign = sign(buildParams, config.apiUrl, config.VUE_APP_PLATFORM_APP_SECRET)\n  buildParams.sign = sign(buildParams, process.env.VUE_APP_PLATFORM_API, process.env.VUE_APP_PLATFORM_APP_SECRET);\n  return buildParams;\n}\n\n// const addErrorLog = errorInfo => {\n//   const { statusText, status, request: { responseURL } } = errorInfo\n//   const info = {\n//     type: 'ajax',\n//     code: status,\n//     mes: statusText,\n//     url: responseURL\n//   }\n//   if (!responseURL.includes('save_error_logger')) store.dispatch('addErrorLog', info)\n// }\n\nclass PlatformApis {\n  constructor (baseUrl) {\n    this.baseUrl = baseUrl\n    this.queue = {}\n  }\n\n  getInsideConfig () {\n    const config = {\n      baseURL: this.baseUrl,\n      headers: {}\n    }\n    return config\n  }\n\n  destroy (url) {\n    delete this.queue[url]\n    // if (!Object.keys(this.queue).length) {\n    //   Spin.hide()\n    // }\n  }\n\n  interceptors (instance, url) {\n    // 请求拦截\n    instance.interceptors.request.use(config => {\n      // 添加全局的loading...\n      // if (!Object.keys(this.queue).length) {\n      //   Spin.show() // 不建议开启，因为界面不友好\n      // }\n      this.queue[url] = true\n      // const token = store.state.platform.sessionid\n      // if (!hasOneOf(config.data.method.split('.'), ['login','register'])) {\n      //   if (!config.params) {\n      //     config.params = {}\n      //   }\n      //   if (token) {\n      //     config.params.sessionid = token\n      //   }\n      // }\n      // // token && (config.headers.sessionid = token)\n      const data = config.data\n\n      // removed the hardcore code when deploy to prod\n      // if (data.method.includes('.merchant.') && !hasKey(data, 'store_id')) data.store_id = process.env.VUE_APP_STORE_ID\n\n      data && (config.data = qs.stringify(buildParams(data)))\n      return config\n    }, error => {\n      return Promise.reject(error)\n    })\n    // 响应拦截\n    instance.interceptors.response.use(res => {\n      this.destroy(url)\n      // res.data数据部分格式为：{ data: ..., return_code: ..., return_message: ...}\n      const { data, return_code, return_message } = res.data\n      if (return_code === 0) {\n        return { data, return_code, return_message }\n      } else {\n        // const { request: { statusText, status }, config } = JSON.parse(JSON.stringify(error))\n        // const errorInfo = {\n        //   statusText: return_message,\n        //   status: return_code,\n        //   request: { responseURL: `[api•platform]${url}` }\n        // }\n        // addErrorLog(errorInfo)\n        Message.error({ content: return_message, closable: true, duration: 5 })\n        return Promise.reject(res.data)\n      }\n    }, error => {\n      // console.log(error)\n      // console.log(error.response)\n      this.destroy(url)\n      // let errorInfo = error.response\n      // if (!errorInfo) {\n      //   const { request: { statusText, status }, config } = JSON.parse(JSON.stringify(error))\n      //   errorInfo = {\n      //     statusText,\n      //     status,\n      //     request: { responseURL: config.url }\n      //   }\n      // }\n      // addErrorLog(errorInfo)\n      return Promise.reject(error)\n    })\n  }\n\n  request (options) {\n    const instance = axios.create()\n    options = Object.assign(this.getInsideConfig(), options)\n    this.interceptors(instance, options.url)\n    return instance(options)\n  }\n}\nexport default PlatformApis\n"]}]}