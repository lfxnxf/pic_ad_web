{"remainingRequest":"/Users/zhang/canteen_manage/node_modules/babel-loader/lib/index.js!/Users/zhang/canteen_manage/src/libs/platform.js","dependencies":[{"path":"/Users/zhang/canteen_manage/src/libs/platform.js","mtime":1646816807875},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMvemhhbmcvY2FudGVlbl9tYW5hZ2Uvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvVXNlcnMvemhhbmcvY2FudGVlbl9tYW5hZ2Uvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucGFyc2UtaW50LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZGF0ZS50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzLmpzIjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHFzIGZyb20gJ3FzJzsKaW1wb3J0IHN0b3JlIGZyb20gJ0Avc3RvcmUnOwppbXBvcnQgc2lnbiBmcm9tICdAL2xpYnMvc2lnbic7CmltcG9ydCBkZXZpY2UgZnJvbSAnQC9saWJzL2RldmljZSc7CmltcG9ydCB7IE1lc3NhZ2UgfSBmcm9tICd2aWV3LWRlc2lnbic7CmltcG9ydCB7IGhhc09uZU9mIH0gZnJvbSAnLi90b29scyc7CmltcG9ydCBjb25maWcgZnJvbSAnQC9jb25maWcnOwovKioKICAgICog57uE6KOF5YWs5YWx5Y+C5pWwCiAgICAqIEBwYXJhbSB7U3RyaW5nfSBwYXJhbXMg5o6l5Y+j5Y2V54us6K+35rGC5Y+C5pWwCiAgICAqLwoKZnVuY3Rpb24gYnVpbGRQYXJhbXMoKSB7CiAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CiAgLy8g5YWs5YWx5Y+C5pWwCiAgdmFyIGNvbW1vblBhcmFtcyA9IHsKICAgIC8vIGFwcGtleTogY29uZmlnLlZVRV9BUFBfUExBVEZPUk1fQVBQX0tFWSwKICAgIC8vIGNoYW5uZWxfaWQ6IGNvbmZpZy5WVUVfQVBQX1BMQVRGT1JNX0FQUF9DSEFOTkVMX0lELAogICAgYXBwa2V5OiBwcm9jZXNzLmVudi5WVUVfQVBQX1BMQVRGT1JNX0FQUF9LRVksCiAgICBjaGFubmVsX2lkOiBwcm9jZXNzLmVudi5WVUVfQVBQX1BMQVRGT1JNX0FQUF9DSEFOTkVMX0lELAogICAgYXBpX3ZlcnNpb246ICcxJywKICAgIHRpbWVzdGFtcDogcGFyc2VJbnQobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSwKICAgIHVhOiAncGMnLAogICAgZGV2aWNlaWQ6ICdwYycsCiAgICBjbGllbnQ6ICdwYycsCiAgICBwcm9kdWN0X2NvZGU6ICczMTE5JywKICAgIG5vbmNlOiBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgMTUpCiAgfTsgLy8g5ZCI5bm25Y+C5pWwCgogIHZhciBidWlsZFBhcmFtcyA9IE9iamVjdC5hc3NpZ24oY29tbW9uUGFyYW1zLCBwYXJhbXMpOwogIE9iamVjdC5rZXlzKGJ1aWxkUGFyYW1zKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgIGlmIChidWlsZFBhcmFtc1trZXldID09PSBudWxsIHx8IGJ1aWxkUGFyYW1zW2tleV0gPT09IHVuZGVmaW5lZCB8fCBidWlsZFBhcmFtc1trZXldID09PSAnJykgewogICAgICBkZWxldGUgYnVpbGRQYXJhbXNba2V5XTsKICAgIH0KICB9KTsgLy8g562+5ZCNCiAgLy8gYnVpbGRQYXJhbXMuc2lnbiA9IHNpZ24oYnVpbGRQYXJhbXMsIGNvbmZpZy5hcGlVcmwsIGNvbmZpZy5WVUVfQVBQX1BMQVRGT1JNX0FQUF9TRUNSRVQpCgogIGJ1aWxkUGFyYW1zLnNpZ24gPSBzaWduKGJ1aWxkUGFyYW1zLCBwcm9jZXNzLmVudi5WVUVfQVBQX1BMQVRGT1JNX0FQSSwgcHJvY2Vzcy5lbnYuVlVFX0FQUF9QTEFURk9STV9BUFBfU0VDUkVUKTsKICByZXR1cm4gYnVpbGRQYXJhbXM7Cn0gLy8gY29uc3QgYWRkRXJyb3JMb2cgPSBlcnJvckluZm8gPT4gewovLyAgIGNvbnN0IHsgc3RhdHVzVGV4dCwgc3RhdHVzLCByZXF1ZXN0OiB7IHJlc3BvbnNlVVJMIH0gfSA9IGVycm9ySW5mbwovLyAgIGNvbnN0IGluZm8gPSB7Ci8vICAgICB0eXBlOiAnYWpheCcsCi8vICAgICBjb2RlOiBzdGF0dXMsCi8vICAgICBtZXM6IHN0YXR1c1RleHQsCi8vICAgICB1cmw6IHJlc3BvbnNlVVJMCi8vICAgfQovLyAgIGlmICghcmVzcG9uc2VVUkwuaW5jbHVkZXMoJ3NhdmVfZXJyb3JfbG9nZ2VyJykpIHN0b3JlLmRpc3BhdGNoKCdhZGRFcnJvckxvZycsIGluZm8pCi8vIH0KCgp2YXIgUGxhdGZvcm1BcGlzID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBQbGF0Zm9ybUFwaXMoYmFzZVVybCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBsYXRmb3JtQXBpcyk7CgogICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDsKICAgIHRoaXMucXVldWUgPSB7fTsKICB9CgogIF9jcmVhdGVDbGFzcyhQbGF0Zm9ybUFwaXMsIFt7CiAgICBrZXk6ICJnZXRJbnNpZGVDb25maWciLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEluc2lkZUNvbmZpZygpIHsKICAgICAgdmFyIGNvbmZpZyA9IHsKICAgICAgICBiYXNlVVJMOiB0aGlzLmJhc2VVcmwsCiAgICAgICAgaGVhZGVyczoge30KICAgICAgfTsKICAgICAgcmV0dXJuIGNvbmZpZzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkZXN0cm95IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KHVybCkgewogICAgICBkZWxldGUgdGhpcy5xdWV1ZVt1cmxdOyAvLyBpZiAoIU9iamVjdC5rZXlzKHRoaXMucXVldWUpLmxlbmd0aCkgewogICAgICAvLyAgIFNwaW4uaGlkZSgpCiAgICAgIC8vIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJpbnRlcmNlcHRvcnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGludGVyY2VwdG9ycyhpbnN0YW5jZSwgdXJsKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvLyDor7fmsYLmi6bmiKoKICAgICAgaW5zdGFuY2UuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKGZ1bmN0aW9uIChjb25maWcpIHsKICAgICAgICAvLyDmt7vliqDlhajlsYDnmoRsb2FkaW5nLi4uCiAgICAgICAgLy8gaWYgKCFPYmplY3Qua2V5cyh0aGlzLnF1ZXVlKS5sZW5ndGgpIHsKICAgICAgICAvLyAgIFNwaW4uc2hvdygpIC8vIOS4jeW7uuiuruW8gOWQr++8jOWboOS4uueVjOmdouS4jeWPi+WlvQogICAgICAgIC8vIH0KICAgICAgICBfdGhpcy5xdWV1ZVt1cmxdID0gdHJ1ZTsgLy8gY29uc3QgdG9rZW4gPSBzdG9yZS5zdGF0ZS5wbGF0Zm9ybS5zZXNzaW9uaWQKICAgICAgICAvLyBpZiAoIWhhc09uZU9mKGNvbmZpZy5kYXRhLm1ldGhvZC5zcGxpdCgnLicpLCBbJ2xvZ2luJywncmVnaXN0ZXInXSkpIHsKICAgICAgICAvLyAgIGlmICghY29uZmlnLnBhcmFtcykgewogICAgICAgIC8vICAgICBjb25maWcucGFyYW1zID0ge30KICAgICAgICAvLyAgIH0KICAgICAgICAvLyAgIGlmICh0b2tlbikgewogICAgICAgIC8vICAgICBjb25maWcucGFyYW1zLnNlc3Npb25pZCA9IHRva2VuCiAgICAgICAgLy8gICB9CiAgICAgICAgLy8gfQogICAgICAgIC8vIC8vIHRva2VuICYmIChjb25maWcuaGVhZGVycy5zZXNzaW9uaWQgPSB0b2tlbikKCiAgICAgICAgdmFyIGRhdGEgPSBjb25maWcuZGF0YTsgLy8gcmVtb3ZlZCB0aGUgaGFyZGNvcmUgY29kZSB3aGVuIGRlcGxveSB0byBwcm9kCiAgICAgICAgLy8gaWYgKGRhdGEubWV0aG9kLmluY2x1ZGVzKCcubWVyY2hhbnQuJykgJiYgIWhhc0tleShkYXRhLCAnc3RvcmVfaWQnKSkgZGF0YS5zdG9yZV9pZCA9IHByb2Nlc3MuZW52LlZVRV9BUFBfU1RPUkVfSUQKCiAgICAgICAgZGF0YSAmJiAoY29uZmlnLmRhdGEgPSBxcy5zdHJpbmdpZnkoYnVpbGRQYXJhbXMoZGF0YSkpKTsKICAgICAgICByZXR1cm4gY29uZmlnOwogICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwogICAgICB9KTsgLy8g5ZON5bqU5oum5oiqCgogICAgICBpbnN0YW5jZS5pbnRlcmNlcHRvcnMucmVzcG9uc2UudXNlKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpcy5kZXN0cm95KHVybCk7IC8vIHJlcy5kYXRh5pWw5o2u6YOo5YiG5qC85byP5Li677yaeyBkYXRhOiAuLi4sIHJldHVybl9jb2RlOiAuLi4sIHJldHVybl9tZXNzYWdlOiAuLi59CgoKICAgICAgICB2YXIgX3JlcyRkYXRhID0gcmVzLmRhdGEsCiAgICAgICAgICAgIGRhdGEgPSBfcmVzJGRhdGEuZGF0YSwKICAgICAgICAgICAgcmV0dXJuX2NvZGUgPSBfcmVzJGRhdGEucmV0dXJuX2NvZGUsCiAgICAgICAgICAgIHJldHVybl9tZXNzYWdlID0gX3JlcyRkYXRhLnJldHVybl9tZXNzYWdlOwoKICAgICAgICBpZiAocmV0dXJuX2NvZGUgPT09IDApIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGRhdGE6IGRhdGEsCiAgICAgICAgICAgIHJldHVybl9jb2RlOiByZXR1cm5fY29kZSwKICAgICAgICAgICAgcmV0dXJuX21lc3NhZ2U6IHJldHVybl9tZXNzYWdlCiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBjb25zdCB7IHJlcXVlc3Q6IHsgc3RhdHVzVGV4dCwgc3RhdHVzIH0sIGNvbmZpZyB9ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShlcnJvcikpCiAgICAgICAgICAvLyBjb25zdCBlcnJvckluZm8gPSB7CiAgICAgICAgICAvLyAgIHN0YXR1c1RleHQ6IHJldHVybl9tZXNzYWdlLAogICAgICAgICAgLy8gICBzdGF0dXM6IHJldHVybl9jb2RlLAogICAgICAgICAgLy8gICByZXF1ZXN0OiB7IHJlc3BvbnNlVVJMOiBgW2FwaeKAonBsYXRmb3JtXSR7dXJsfWAgfQogICAgICAgICAgLy8gfQogICAgICAgICAgLy8gYWRkRXJyb3JMb2coZXJyb3JJbmZvKQogICAgICAgICAgTWVzc2FnZS5lcnJvcih7CiAgICAgICAgICAgIGNvbnRlbnQ6IHJldHVybl9tZXNzYWdlLAogICAgICAgICAgICBjbG9zYWJsZTogdHJ1ZSwKICAgICAgICAgICAgZHVyYXRpb246IDUKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlcy5kYXRhKTsKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIC8vIGNvbnNvbGUubG9nKGVycm9yKQogICAgICAgIC8vIGNvbnNvbGUubG9nKGVycm9yLnJlc3BvbnNlKQogICAgICAgIF90aGlzLmRlc3Ryb3kodXJsKTsgLy8gbGV0IGVycm9ySW5mbyA9IGVycm9yLnJlc3BvbnNlCiAgICAgICAgLy8gaWYgKCFlcnJvckluZm8pIHsKICAgICAgICAvLyAgIGNvbnN0IHsgcmVxdWVzdDogeyBzdGF0dXNUZXh0LCBzdGF0dXMgfSwgY29uZmlnIH0gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGVycm9yKSkKICAgICAgICAvLyAgIGVycm9ySW5mbyA9IHsKICAgICAgICAvLyAgICAgc3RhdHVzVGV4dCwKICAgICAgICAvLyAgICAgc3RhdHVzLAogICAgICAgIC8vICAgICByZXF1ZXN0OiB7IHJlc3BvbnNlVVJMOiBjb25maWcudXJsIH0KICAgICAgICAvLyAgIH0KICAgICAgICAvLyB9CiAgICAgICAgLy8gYWRkRXJyb3JMb2coZXJyb3JJbmZvKQoKCiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVxdWVzdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVxdWVzdChvcHRpb25zKSB7CiAgICAgIHZhciBpbnN0YW5jZSA9IGF4aW9zLmNyZWF0ZSgpOwogICAgICBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih0aGlzLmdldEluc2lkZUNvbmZpZygpLCBvcHRpb25zKTsKICAgICAgdGhpcy5pbnRlcmNlcHRvcnMoaW5zdGFuY2UsIG9wdGlvbnMudXJsKTsKICAgICAgcmV0dXJuIGluc3RhbmNlKG9wdGlvbnMpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFBsYXRmb3JtQXBpczsKfSgpOwoKZXhwb3J0IGRlZmF1bHQgUGxhdGZvcm1BcGlzOw=="},{"version":3,"sources":["/Users/zhang/canteen_manage/src/libs/platform.js"],"names":["axios","qs","store","sign","device","Message","hasOneOf","config","buildParams","params","commonParams","appkey","process","env","VUE_APP_PLATFORM_APP_KEY","channel_id","VUE_APP_PLATFORM_APP_CHANNEL_ID","api_version","timestamp","parseInt","Date","getTime","ua","deviceid","client","product_code","nonce","Math","random","toString","substr","Object","assign","keys","forEach","key","undefined","VUE_APP_PLATFORM_API","VUE_APP_PLATFORM_APP_SECRET","PlatformApis","baseUrl","queue","baseURL","headers","url","instance","interceptors","request","use","data","stringify","error","Promise","reject","response","res","destroy","return_code","return_message","content","closable","duration","options","create","getInsideConfig"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport qs from 'qs'\nimport store from '@/store'\nimport sign from '@/libs/sign'\nimport device from '@/libs/device'\nimport { Message } from 'view-design'\nimport { hasOneOf } from './tools'\nimport config from '@/config'\n\n/**\n    * 组装公共参数\n    * @param {String} params 接口单独请求参数\n    */\nfunction buildParams (params = {}) {\n  // 公共参数\n  const commonParams = {\n    // appkey: config.VUE_APP_PLATFORM_APP_KEY,\n    // channel_id: config.VUE_APP_PLATFORM_APP_CHANNEL_ID,\n    appkey: process.env.VUE_APP_PLATFORM_APP_KEY,\n    channel_id: process.env.VUE_APP_PLATFORM_APP_CHANNEL_ID,\n    api_version: '1',\n    timestamp: parseInt(new Date().getTime() / 1000),\n    ua: 'pc',\n    deviceid: 'pc',\n    client: 'pc',\n    product_code: '3119',\n    nonce: Math.random().toString(36).substr(2, 15)\n  }\n  // 合并参数\n  const buildParams = Object.assign(commonParams, params)\n  Object.keys(buildParams).forEach((key) => {\n    if (buildParams[key] === null || buildParams[key] === undefined || buildParams[key]==='') {\n      delete buildParams[key]\n    }\n  })\n  // 签名\n  // buildParams.sign = sign(buildParams, config.apiUrl, config.VUE_APP_PLATFORM_APP_SECRET)\n  buildParams.sign = sign(buildParams, process.env.VUE_APP_PLATFORM_API, process.env.VUE_APP_PLATFORM_APP_SECRET);\n  return buildParams;\n}\n\n// const addErrorLog = errorInfo => {\n//   const { statusText, status, request: { responseURL } } = errorInfo\n//   const info = {\n//     type: 'ajax',\n//     code: status,\n//     mes: statusText,\n//     url: responseURL\n//   }\n//   if (!responseURL.includes('save_error_logger')) store.dispatch('addErrorLog', info)\n// }\n\nclass PlatformApis {\n  constructor (baseUrl) {\n    this.baseUrl = baseUrl\n    this.queue = {}\n  }\n\n  getInsideConfig () {\n    const config = {\n      baseURL: this.baseUrl,\n      headers: {}\n    }\n    return config\n  }\n\n  destroy (url) {\n    delete this.queue[url]\n    // if (!Object.keys(this.queue).length) {\n    //   Spin.hide()\n    // }\n  }\n\n  interceptors (instance, url) {\n    // 请求拦截\n    instance.interceptors.request.use(config => {\n      // 添加全局的loading...\n      // if (!Object.keys(this.queue).length) {\n      //   Spin.show() // 不建议开启，因为界面不友好\n      // }\n      this.queue[url] = true\n      // const token = store.state.platform.sessionid\n      // if (!hasOneOf(config.data.method.split('.'), ['login','register'])) {\n      //   if (!config.params) {\n      //     config.params = {}\n      //   }\n      //   if (token) {\n      //     config.params.sessionid = token\n      //   }\n      // }\n      // // token && (config.headers.sessionid = token)\n      const data = config.data\n\n      // removed the hardcore code when deploy to prod\n      // if (data.method.includes('.merchant.') && !hasKey(data, 'store_id')) data.store_id = process.env.VUE_APP_STORE_ID\n\n      data && (config.data = qs.stringify(buildParams(data)))\n      return config\n    }, error => {\n      return Promise.reject(error)\n    })\n    // 响应拦截\n    instance.interceptors.response.use(res => {\n      this.destroy(url)\n      // res.data数据部分格式为：{ data: ..., return_code: ..., return_message: ...}\n      const { data, return_code, return_message } = res.data\n      if (return_code === 0) {\n        return { data, return_code, return_message }\n      } else {\n        // const { request: { statusText, status }, config } = JSON.parse(JSON.stringify(error))\n        // const errorInfo = {\n        //   statusText: return_message,\n        //   status: return_code,\n        //   request: { responseURL: `[api•platform]${url}` }\n        // }\n        // addErrorLog(errorInfo)\n        Message.error({ content: return_message, closable: true, duration: 5 })\n        return Promise.reject(res.data)\n      }\n    }, error => {\n      // console.log(error)\n      // console.log(error.response)\n      this.destroy(url)\n      // let errorInfo = error.response\n      // if (!errorInfo) {\n      //   const { request: { statusText, status }, config } = JSON.parse(JSON.stringify(error))\n      //   errorInfo = {\n      //     statusText,\n      //     status,\n      //     request: { responseURL: config.url }\n      //   }\n      // }\n      // addErrorLog(errorInfo)\n      return Promise.reject(error)\n    })\n  }\n\n  request (options) {\n    const instance = axios.create()\n    options = Object.assign(this.getInsideConfig(), options)\n    this.interceptors(instance, options.url)\n    return instance(options)\n  }\n}\nexport default PlatformApis\n"]}]}