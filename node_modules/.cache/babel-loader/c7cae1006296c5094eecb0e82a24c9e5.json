{"remainingRequest":"/Users/zhang/canteen_manage/node_modules/babel-loader/lib/index.js!/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhang/canteen_manage/src/views/common/login/thirdauth.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhang/canteen_manage/src/views/common/login/thirdauth.vue","mtime":1638355006778},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL3poYW5nL2NhbnRlZW5fbWFuYWdlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgbWFwQWN0aW9ucywgbWFwU3RhdGUsIG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdUaGlyZExvZ2luTW9kYWwnLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwcm9jZXNzVGV4dDogJ+esrOS4ieaWueaOiOadg+eZu+W9leS4rS4uLi4uLicKICAgIH07CiAgfSwKICBjb21wdXRlZDogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG1hcFN0YXRlKHsKICAgIHRoaXJkVG9rZW46IGZ1bmN0aW9uIHRoaXJkVG9rZW4oc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlLmF1dGguaWNwQWNjZXNzVG9rZW47CiAgICB9LAogICAgc210VXNlckluZm86IGZ1bmN0aW9uIHNtdFVzZXJJbmZvKHN0YXRlKSB7CiAgICAgIHJldHVybiBzdGF0ZS51c2VyLnVzZXJJbmZvOwogICAgfQogIH0pKSwgbWFwR2V0dGVycyhbJ2hhc1dhbGxldCddKSksIHt9LCB7CiAgICB0aGlyZENvZGU6IGZ1bmN0aW9uIHRoaXJkQ29kZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHJvdXRlLnF1ZXJ5LmNvZGU7CiAgICB9CiAgfSksCiAgbWV0aG9kczogX29iamVjdFNwcmVhZCh7fSwgbWFwQWN0aW9ucyhbJ2ZldGNoSWNwQWNjZXNzVG9rZW4nLCAnaWNwQXV0aExvZ2luJ10pKSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB0aGlzLmZldGNoSWNwQWNjZXNzVG9rZW4oewogICAgICBncmFudF90eXBlOiAnYXV0aG9yaXphdGlvbl9jb2RlJywKICAgICAgY29kZTogdGhpcy50aGlyZENvZGUKICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5wcm9jZXNzVGV4dCA9ICfnrKzkuInmlrnlt7LmjojmnYPvvIznlKjmiLfnmbvlvZXkuK0uLi4uLi4nOwoKICAgICAgX3RoaXMuaWNwQXV0aExvZ2luKHsKICAgICAgICBhY2Nlc3NfdG9rZW46IF90aGlzLnRoaXJkVG9rZW4KICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMucHJvY2Vzc1RleHQgPSAn56ys5LiJ5pa555So5oi355m75b2V5oiQ5YqfJzsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycikgewogICAgICAgIF90aGlzLnByb2Nlc3NUZXh0ID0gJ+esrOS4ieaWueeUqOaIt+eZu+W9leaIkOWKn+Wksei0pSc7CgogICAgICAgIF90aGlzLiRNZXNzYWdlLmVycm9yKGVycik7CiAgICAgIH0pOwogICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycikgewogICAgICBfdGhpcy5wcm9jZXNzVGV4dCA9ICfnrKzkuInmlrnmjojmnYPlpLHotKUnOwoKICAgICAgX3RoaXMuJE1lc3NhZ2UuZXJyb3IoZXJyKTsKICAgIH0pOwogIH0KfTs="},{"version":3,"sources":["thirdauth.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEA,SAAA,UAAA,EAAA,QAAA,EAAA,UAAA,QAAA,MAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,iBADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,WAAA,EAAA;AADA,KAAA;AAGA,GANA;AAOA,EAAA,QAAA,gDACA,QAAA,CAAA;AACA,IAAA,UAAA,EAAA,oBAAA,KAAA;AAAA,aAAA,KAAA,CAAA,IAAA,CAAA,cAAA;AAAA,KADA;AAEA,IAAA,WAAA,EAAA,qBAAA,KAAA;AAAA,aAAA,KAAA,CAAA,IAAA,CAAA,QAAA;AAAA;AAFA,GAAA,CADA,GAKA,UAAA,CAAA,CAAA,WAAA,CAAA,CALA;AAMA,IAAA,SANA,uBAMA;AACA,aAAA,KAAA,MAAA,CAAA,KAAA,CAAA,IAAA;AACA;AARA,IAPA;AAiBA,EAAA,OAAA,oBACA,UAAA,CAAA,CAAA,qBAAA,EAAA,cAAA,CAAA,CADA,CAjBA;AAoBA,EAAA,OApBA,qBAoBA;AAAA;;AACA,SAAA,mBAAA,CACA;AACA,MAAA,UAAA,EAAA,oBADA;AAEA,MAAA,IAAA,EAAA,KAAA;AAFA,KADA,EAKA,IALA,CAKA,YAAA;AACA,MAAA,KAAA,CAAA,WAAA,GAAA,oBAAA;;AACA,MAAA,KAAA,CAAA,YAAA,CAAA;AAAA,QAAA,YAAA,EAAA,KAAA,CAAA;AAAA,OAAA,EAAA,IAAA,CAAA,YAAA;AACA,QAAA,KAAA,CAAA,WAAA,GAAA,WAAA;AACA,OAFA,WAEA,UAAA,GAAA,EAAA;AACA,QAAA,KAAA,CAAA,WAAA,GAAA,aAAA;;AACA,QAAA,KAAA,CAAA,QAAA,CAAA,KAAA,CAAA,GAAA;AACA,OALA;AAMA,KAbA,WAaA,UAAA,GAAA,EAAA;AACA,MAAA,KAAA,CAAA,WAAA,GAAA,SAAA;;AACA,MAAA,KAAA,CAAA,QAAA,CAAA,KAAA,CAAA,GAAA;AACA,KAhBA;AAiBA;AAtCA,CAAA","sourcesContent":["<template>\n    <div class=\"third-auth-page\">\n        <!-- <Row v-if=\"!needThirdUser\" :gutter=\"16\">\n            <Col span=\"11\">\n                <Card style=\"width: 320px\">\n                    <div slot=\"title\">\n                        <Avatar :src=\"require('@/assets/images/icplogo32.png')\" />\n                        云门户\n                    </div>\n                    <List v-if=\"thirdUserinfo\">\n                        <ListItem style=\"text-align:center\">\n                            {{ `账号: ${thirdUserinfo.userName}` }}\n                        </ListItem>\n                         <ListItem style=\"text-align:center\">\n                            {{ `名称: ${thirdUserinfo.name}` }}\n                        </ListItem>\n                    </List>\n                </Card>\n            </Col>\n            <Col span=\"2\">\n                <Spin size=\"large\">\n                    <Icon type=\"md-sync\" size=24 class=\"demo-spin-icon-load\"></Icon>\n                </Spin>\n            </Col>\n            <Col span=\"11\">\n                <Card style=\"width: 320px\">\n                    <div slot=\"title\">\n                        <Avatar :src=\"require('@/assets/images/icplogo32.png')\" />\n                        小付通行证\n                    </div>\n                    <List v-if=\"smtUserInfo\">\n                        <ListItem style=\"text-align:center\">\n                            {{ `账号: ${smtUserInfo.username}` }}\n                        </ListItem>\n                         <ListItem style=\"text-align:center\">\n                            {{ `名称: ${smtUserInfo.name}` }}\n                        </ListItem>\n                    </List>\n                    <Form ref=\"smtLoginForm\"></Form>\n                </Card>\n            </Col>\n        </Row> -->\n        <Spin v-if=\"!smtUserInfo\" size=\"large\">\n            <Icon type=\"ios-loading\" size=24 class=\"demo-spin-icon-load\"></Icon>\n            <div>{{ processText }}</div>\n        </Spin>\n        <Card  v-else style=\"width: 480px\">\n            <div slot=\"title\">\n                <Avatar :src=\"require('@/assets/images/icplogo32.png')\" />\n                小付通行证\n            </div>\n            <List>\n                <ListItem style=\"text-align:center\">\n                    {{ `账号: ${smtUserInfo.reg_username}` }}\n                </ListItem>\n                <ListItem style=\"text-align:center\">\n                    {{ `名称: ${smtUserInfo.nickname}` }}\n                </ListItem>\n                <ListItem>\n                    {{ `钱包状态:` }}\n                    <Tag v-if=\"hasWallet\" color=\"success\">已开通</Tag>\n                    <div v-else>\n                    <Tag color=\"error\">未开通</Tag>\n                    请您选择<router-link :to=\"{ name: 'RegComplete', params: { step: 'open_wallet' } }\">立即开通</router-link>\n                    {{`                  或者                  `}}\n                    <router-link to=\"/\">暂时跳过</router-link>\n                    </div>\n                </ListItem>\n            </List>\n        </Card>\n    </div>\n</template>\n<script>\n    import { mapActions, mapState, mapGetters } from 'vuex';\n\n    export default {\n        name: 'ThirdLoginModal',\n        data() {\n            return {\n                processText: '第三方授权登录中......'\n            }\n        },\n        computed: {\n            ...mapState({\n                thirdToken: state => state.auth.icpAccessToken,\n                smtUserInfo: state => state.user.userInfo\n            }),\n            ...mapGetters(['hasWallet']),\n            thirdCode() {\n                return this.$route.query.code\n            }\n        },\n        methods: {\n            ...mapActions(['fetchIcpAccessToken', 'icpAuthLogin'])\n        },\n        mounted () {\n            this.fetchIcpAccessToken(\n                {\n                    grant_type: 'authorization_code',\n                    code: this.thirdCode\n                }\n            ).then(() => {\n                this.processText = '第三方已授权，用户登录中......';\n                this.icpAuthLogin({ access_token: this.thirdToken }).then(() => {\n                    this.processText = '第三方用户登录成功';\n                }).catch(err => {\n                    this.processText = '第三方用户登录成功失败';\n                    this.$Message.error(err);\n                    });\n            }).catch(err => {\n                this.processText = '第三方授权失败';\n                this.$Message.error(err);\n            });\n        },\n    }\n</script>\n\n<style lang=\"less\" scoped>\n.third-auth-page {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n    @keyframes ani-demo-spin {\n        from { transform: rotate(0deg);}\n        50%  { transform: rotate(180deg);}\n        to   { transform: rotate(360deg);}\n    }\n    .demo-spin-icon-load{\n        animation: ani-demo-spin 1s linear infinite;\n    }\n    .ivu-row {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n}\n</style>\n"],"sourceRoot":"src/views/common/login"}]}