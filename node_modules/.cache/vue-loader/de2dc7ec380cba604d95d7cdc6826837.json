{"remainingRequest":"/Users/zhang/工作/pic_ad/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhang/工作/pic_ad/src/views/components/input-excel/inputExcel.vue?vue&type=style&index=0&id=03f616f7&scoped=true&lang=css&","dependencies":[{"path":"/Users/zhang/工作/pic_ad/src/views/components/input-excel/inputExcel.vue","mtime":1638355006788},{"path":"/Users/zhang/工作/pic_ad/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/工作/pic_ad/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zhang/工作/pic_ad/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zhang/工作/pic_ad/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/工作/pic_ad/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5pbnB1dC1maWxlIHsKICBkaXNwbGF5OiBub25lOwp9Cg=="},{"version":3,"sources":["inputExcel.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+EA;AACA;AACA","file":"inputExcel.vue","sourceRoot":"src/views/components/input-excel","sourcesContent":["<template>\n  <span>\n    <input v-if=\"isShow\" class=\"input-file\" type=\"file\" @change=\"exportData\"\n           accept=\".xlsx, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\"/>\n    <Button type=\"success\" icon=\"md-arrow-round-down\" @click=\"btnClick\">{{btnName}}</Button>\n  </span>\n</template>\n\n<script>\nimport XLSX from 'xlsx'\n\nexport default {\n  name: \"inputExcel\",\n  props: {\n    btnName: String,\n    default: \"选择excel文件\"\n  },\n  data() {\n    return {\n      isShow: true\n    }\n  },\n  methods: {\n    btnClick() {\n\n      if (this.isShow === false) {\n        this.isShow = true\n        setTimeout(this.querry, 150)\n      } else {\n        this.querry()\n      }\n\n    },\n\n    querry() {\n\n      document.querySelector(\".input-file\").click();\n    },\n    exportData(event) {\n\n      if (!event.currentTarget.files.length) {\n        return;\n      }\n      const that = this;\n      // 拿取文件对象\n      var f = event.currentTarget.files[0];\n      // 用FileReader来读取\n      var reader = new FileReader();\n      // 重写FileReader上的readAsBinaryString方法\n      FileReader.prototype.readAsBinaryString = function (f) {\n        var binary = \"\";\n        var wb; // 读取完成的数据\n        var outdata; // 你需要的数据\n        var reader = new FileReader();\n        reader.onload = function (e) {\n          // 读取成Uint8Array，再转换为Unicode编码（Unicode占两个字节）\n          var bytes = new Uint8Array(reader.result);\n          var length = bytes.byteLength;\n          for (var i = 0; i < length; i++) {\n            binary += String.fromCharCode(bytes[i]);\n          }\n          // 接下来就是xlsx了，具体可看api\n          wb = XLSX.read(binary, {\n            type: \"binary\"\n          });\n          outdata = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);\n          // 自定义方法向父组件传递数据\n          that.$emit(\"getResult\", outdata);\n        };\n        reader.readAsArrayBuffer(f);\n      };\n      reader.readAsBinaryString(f);\n      this.isShow = false\n    }\n  }\n}\n</script>\n\n<style scoped>\n.input-file {\n  display: none;\n}\n</style>\n"]}]}