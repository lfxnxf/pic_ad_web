{"remainingRequest":"/Users/zhang/工作/pic_ad/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhang/工作/pic_ad/src/views/staff-management/dining-staff/components/add-otheruser.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhang/工作/pic_ad/src/views/staff-management/dining-staff/components/add-otheruser.vue","mtime":1638522076785},{"path":"/Users/zhang/工作/pic_ad/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/工作/pic_ad/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhang/工作/pic_ad/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/工作/pic_ad/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBfIGZyb20gInVuZGVyc2NvcmUiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJhZGQtb3RoZXJ1c2VyLW1vZGFsLnZ1ZSIsCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBidG5Mb2FkaW5nOiBmYWxzZSwKICAgICAgZm9ybTogewogICAgICAgIG5hbWU6ICcnLAogICAgICAgIGlkX25vOiAnJywKICAgICAgICBwaG9uZXM6ICcnLAogICAgICAgIHJvbGVfaWQ6IHVuZGVmaW5lZCwKICAgICAgICBjYXJkX25vOiAnJywKICAgICAgICBlbWFpbHM6ICcnCiAgICAgIH0sCiAgICAgIHJ1bGVGb3JtOiB7CiAgICAgICAgbmFtZTogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeWnk+WQjScsIHRyaWdnZXI6ICdibHVyJyB9CiAgICAgICAgXSwKICAgICAgICBpZF9ubzogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpei6q+S7veivgeWPtycsIHRyaWdnZXI6ICdibHVyJyB9CiAgICAgICAgXSwKICAgICAgICBwaG9uZXM6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7floavlhpnmiYvmnLrlj7cnLCB0cmlnZ2VyOiAnYmx1cicgfQogICAgICAgIF0sCiAgICAgICAgcm9sZV9pZDogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+mAieaLqeS6uuWRmOexu+WeiycsIHRyaWdnZXI6ICdjaGFuZ2UnIH0KICAgICAgICBdLAogICAgICB9CiAgICB9OwogIH0sCgogIGNvbXBvbmVudHM6IHt9LAoKICBjb21wdXRlZDogewogICAgcm9sZUxpc3QoKXsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLnJvbGUucm9sZUxpc3QucmVzdWx0OwogICAgfSwKCiAgfSwKCiAgbWV0aG9kczogewogICAgYWRkT3RoZXJVc2VyOiBhc3luYyBmdW5jdGlvbigpewogICAgICB0aGlzLiRyZWZzLmZvcm1PdGhlclVzZXJNb2RhbC52YWxpZGF0ZSgodmFsaWQpID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIHRoaXMuYnRuTG9hZGluZyA9IHRydWU7CiAgICAgICAgICBsZXQgcGFyYW1zID0gewogICAgICAgICAgICAuLi50aGlzLmZvcm0sCiAgICAgICAgICAgIG1lcmNoYW50X2lkOiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmN1ck1lcmNoYW50SWQsCiAgICAgICAgICAgIHVzZXJfdHlwZTogMiwKICAgICAgICAgICAgY191c2VyY29kZTogdGhpcy4kc3RvcmUuc3RhdGUudXNlci5lbXBVc2VyQ29kZSwKICAgICAgICAgICAgb3JnX2lkOiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmN1ck9yZ0lkLAogICAgICAgICAgICBvcmdfbmFtZTogdGhpcy4kc3RvcmUuc3RhdGUudXNlci5jdXJPcmdOYW1lLAogICAgICAgICAgICBpc19hZG1pbjogMCwKICAgICAgICAgICAgaXNfd2FsbGV0X2FkbWluOiAwLAogICAgICAgICAgfTsKCiAgICAgICAgICBsZXQgcGFyYW1zRGF0YSA9IFtdOwogICAgICAgICAgcGFyYW1zRGF0YS5wdXNoKHBhcmFtcyk7CgogICAgICAgICAgbGV0IEJhc2U2NCA9IHJlcXVpcmUoJ2pzLWJhc2U2NCcpLkJhc2U2NDsKICAgICAgICAgIGxldCBkZXRhaWxzID0gQmFzZTY0LmVuY29kZShKU09OLnN0cmluZ2lmeShwYXJhbXNEYXRhKSk7CgogICAgICAgICAgbGV0IHJlcVBhcmFtcyA9IHsKICAgICAgICAgICAgc2Vzc2lvbmlkOiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLnRva2VuLAogICAgICAgICAgICB1c2VyX2RldGFpbDogZGV0YWlscywKICAgICAgICAgIH07CgogICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3VzZXJBZGQnLCByZXFQYXJhbXMpLnRoZW4ocmVzPT57CiAgICAgICAgICAgIGlmKHJlcy5yZXR1cm5fY29kZSA9PSAwKXsKICAgICAgICAgICAgICB0aGlzLmJ0bkxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLiRNZXNzYWdlLnN1Y2Nlc3MoJ+a3u+WKoOWwsemkkOS6uuWRmOaIkOWKn++8gScpOwogICAgICAgICAgICAgIHRoaXMuJHBhcmVudC5xdWVyeSgpOwogICAgICAgICAgICAgIC8vIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0T3RoZXJVc2VyTW9kYWwnLCBmYWxzZSk7CiAgICAgICAgICAgICAgdGhpcy4kcmVmcy5mb3JtT3RoZXJVc2VyTW9kYWwucmVzZXRGaWVsZHMoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgIHRoaXMuJE1lc3NhZ2UuZXJyb3IoIumUmeivr+egge+8miIgKyByZXMucmV0dXJuX2NvZGUgKyAiLCDplJnor6/kv6Hmga/vvJoiICsgcmVzLnJldHVybl9tZXNzYWdlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4gewogICAgICAgICAgICB0aGlzLmJ0bkxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgY29uc29sZS5sb2coImFkZE90aGVyVXNlcj09PT09PWVycm9yPj4+PiIgKyBlcnIpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICB9LAogIHdhdGNoOiB7CiAgICBvdGhlclVzZXJBZGRNb2RhbCh2YWwpewogICAgICBpZighdmFsKXsKICAgICAgICB0aGlzLmZvcm0gPSB7CiAgICAgICAgICBuYW1lOiAnJywKICAgICAgICAgIGlkX25vOiAnJywKICAgICAgICAgIHBob25lczogJycsCiAgICAgICAgICByb2xlX2lkOiB1bmRlZmluZWQsCiAgICAgICAgICBjYXJkX25vOiAnJywKICAgICAgICAgIGVtYWlsczogJycKICAgICAgICB9CiAgICAgICAgdGhpcy5idG5Mb2FkaW5nID0gZmFsc2U7CiAgICAgIH1lbHNlewogICAgICAgIC8vIHRoaXMuJHJlZnNbJ2Zvcm1PdGhlclVzZXJNb2RhbCddLnJlc2V0RmllbGRzKCk7CiAgICAgIH0KICAgIH0KICB9Cn0KCg=="},{"version":3,"sources":["add-otheruser.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"add-otheruser.vue","sourceRoot":"src/views/staff-management/dining-staff/components","sourcesContent":["\n<!--  -->\n<template>\n  <div>\n    <Form class=\"form-wrapper margin-top-20\" :model=\"form\" :label-width=\"80\" ref=\"formOtherUserModal\" :rules=\"ruleForm\" >\n      <FormItem label=\"姓名\" prop=\"name\">\n        <Input type=\"text\" v-model=\"form.name\" style=\"width: 80%;\"/>\n      </FormItem>\n      <FormItem label=\"身份证号\" prop=\"id_no\">\n        <Input type=\"text\" v-model=\"form.id_no\" style=\"width: 80%;\"/>\n      </FormItem>\n      <FormItem label=\"手机号\"  prop=\"phones\">\n        <Input type=\"text\" v-model=\"form.phones\" style=\"width: 80%;\"/>\n      </FormItem>\n      <FormItem label=\"人员类型\" prop=\"role_id\">\n        <Select class=\"r\" v-model=\"form.role_id\" style=\"width: 80%;\">\n          <Option v-for=\"item of roleList\" :key=\"item.role_id\" :value=\"item.role_id+''\">{{item.name}}</Option>\n        </Select>\n      </FormItem>\n      <FormItem label=\"就餐卡号\">\n        <Input type=\"text\" v-model=\"form.card_no\" style=\"width: 80%;\"/>\n      </FormItem>\n      <FormItem label=\"邮箱\">\n        <Input type=\"text\" v-model=\"form.emails\" style=\"width: 80%;\"/>\n      </FormItem>\n      <div class=\"text-center margin-bottom-30 margin-top-30\">\n        <Button class=\"margin-right-20\" @click=\"form={};\">重置</Button>\n        <Button type=\"primary\" :loading=\"btnLoading\" @click=\"addOtherUser\">确定</Button>\n      </div>\n\n    </Form>\n  </div>\n</template>\n\n<script>\nimport _ from \"underscore\";\n\nexport default {\n  name: \"add-otheruser-modal.vue\",\n  data () {\n    return {\n      btnLoading: false,\n      form: {\n        name: '',\n        id_no: '',\n        phones: '',\n        role_id: undefined,\n        card_no: '',\n        emails: ''\n      },\n      ruleForm: {\n        name: [\n          { required: true, message: '请输入姓名', trigger: 'blur' }\n        ],\n        id_no: [\n          { required: true, message: '请输入身份证号', trigger: 'blur' }\n        ],\n        phones: [\n          { required: true, message: '请填写手机号', trigger: 'blur' }\n        ],\n        role_id: [\n          { required: true, message: '请选择人员类型', trigger: 'change' }\n        ],\n      }\n    };\n  },\n\n  components: {},\n\n  computed: {\n    roleList(){\n      return this.$store.state.role.roleList.result;\n    },\n\n  },\n\n  methods: {\n    addOtherUser: async function(){\n      this.$refs.formOtherUserModal.validate((valid) => {\n        if (valid) {\n          this.btnLoading = true;\n          let params = {\n            ...this.form,\n            merchant_id: this.$store.state.user.curMerchantId,\n            user_type: 2,\n            c_usercode: this.$store.state.user.empUserCode,\n            org_id: this.$store.state.user.curOrgId,\n            org_name: this.$store.state.user.curOrgName,\n            is_admin: 0,\n            is_wallet_admin: 0,\n          };\n\n          let paramsData = [];\n          paramsData.push(params);\n\n          let Base64 = require('js-base64').Base64;\n          let details = Base64.encode(JSON.stringify(paramsData));\n\n          let reqParams = {\n            sessionid: this.$store.state.user.token,\n            user_detail: details,\n          };\n\n          this.$store.dispatch('userAdd', reqParams).then(res=>{\n            if(res.return_code == 0){\n              this.btnLoading = false;\n              this.$Message.success('添加就餐人员成功！');\n              this.$parent.query();\n              // this.$store.commit('setOtherUserModal', false);\n              this.$refs.formOtherUserModal.resetFields();\n            }\n            else{\n              this.$Message.error(\"错误码：\" + res.return_code + \", 错误信息：\" + res.return_message);\n            }\n          }).catch((err) => {\n            this.btnLoading = false;\n            console.log(\"addOtherUser======error>>>>\" + err);\n          });\n        }\n      })\n    },\n  },\n  watch: {\n    otherUserAddModal(val){\n      if(!val){\n        this.form = {\n          name: '',\n          id_no: '',\n          phones: '',\n          role_id: undefined,\n          card_no: '',\n          emails: ''\n        }\n        this.btnLoading = false;\n      }else{\n        // this.$refs['formOtherUserModal'].resetFields();\n      }\n    }\n  }\n}\n\n</script>\n<style lang='less' scoped>\n</style>\n"]}]}