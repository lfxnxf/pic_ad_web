{"remainingRequest":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhang/canteen_manage/src/views/components/input-excel/inputExcel.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhang/canteen_manage/src/views/components/input-excel/inputExcel.vue","mtime":1638355006788},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBYTFNYIGZyb20gJ3hsc3gnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImlucHV0RXhjZWwiLAogIHByb3BzOiB7CiAgICBidG5OYW1lOiBTdHJpbmcsCiAgICBkZWZhdWx0OiAi6YCJ5oupZXhjZWzmlofku7YiCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNTaG93OiB0cnVlCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBidG5DbGljaygpIHsKCiAgICAgIGlmICh0aGlzLmlzU2hvdyA9PT0gZmFsc2UpIHsKICAgICAgICB0aGlzLmlzU2hvdyA9IHRydWUKICAgICAgICBzZXRUaW1lb3V0KHRoaXMucXVlcnJ5LCAxNTApCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5xdWVycnkoKQogICAgICB9CgogICAgfSwKCiAgICBxdWVycnkoKSB7CgogICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuaW5wdXQtZmlsZSIpLmNsaWNrKCk7CiAgICB9LAogICAgZXhwb3J0RGF0YShldmVudCkgewoKICAgICAgaWYgKCFldmVudC5jdXJyZW50VGFyZ2V0LmZpbGVzLmxlbmd0aCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBjb25zdCB0aGF0ID0gdGhpczsKICAgICAgLy8g5ou/5Y+W5paH5Lu25a+56LGhCiAgICAgIHZhciBmID0gZXZlbnQuY3VycmVudFRhcmdldC5maWxlc1swXTsKICAgICAgLy8g55SoRmlsZVJlYWRlcuadpeivu+WPlgogICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgLy8g6YeN5YaZRmlsZVJlYWRlcuS4iueahHJlYWRBc0JpbmFyeVN0cmluZ+aWueazlQogICAgICBGaWxlUmVhZGVyLnByb3RvdHlwZS5yZWFkQXNCaW5hcnlTdHJpbmcgPSBmdW5jdGlvbiAoZikgewogICAgICAgIHZhciBiaW5hcnkgPSAiIjsKICAgICAgICB2YXIgd2I7IC8vIOivu+WPluWujOaIkOeahOaVsOaNrgogICAgICAgIHZhciBvdXRkYXRhOyAvLyDkvaDpnIDopoHnmoTmlbDmja4KICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIC8vIOivu+WPluaIkFVpbnQ4QXJyYXnvvIzlho3ovazmjaLkuLpVbmljb2Rl57yW56CB77yIVW5pY29kZeWNoOS4pOS4quWtl+iKgu+8iQogICAgICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkocmVhZGVyLnJlc3VsdCk7CiAgICAgICAgICB2YXIgbGVuZ3RoID0gYnl0ZXMuYnl0ZUxlbmd0aDsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgYmluYXJ5ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0pOwogICAgICAgICAgfQogICAgICAgICAgLy8g5o6l5LiL5p2l5bCx5piveGxzeOS6hu+8jOWFt+S9k+WPr+eci2FwaQogICAgICAgICAgd2IgPSBYTFNYLnJlYWQoYmluYXJ5LCB7CiAgICAgICAgICAgIHR5cGU6ICJiaW5hcnkiCiAgICAgICAgICB9KTsKICAgICAgICAgIG91dGRhdGEgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24od2IuU2hlZXRzW3diLlNoZWV0TmFtZXNbMF1dKTsKICAgICAgICAgIC8vIOiHquWumuS5ieaWueazleWQkeeItue7hOS7tuS8oOmAkuaVsOaNrgogICAgICAgICAgdGhhdC4kZW1pdCgiZ2V0UmVzdWx0Iiwgb3V0ZGF0YSk7CiAgICAgICAgfTsKICAgICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZik7CiAgICAgIH07CiAgICAgIHJlYWRlci5yZWFkQXNCaW5hcnlTdHJpbmcoZik7CiAgICAgIHRoaXMuaXNTaG93ID0gZmFsc2UKICAgIH0KICB9Cn0K"},{"version":3,"sources":["inputExcel.vue"],"names":[],"mappings":";;;;;;;;;AASA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"inputExcel.vue","sourceRoot":"src/views/components/input-excel","sourcesContent":["<template>\n  <span>\n    <input v-if=\"isShow\" class=\"input-file\" type=\"file\" @change=\"exportData\"\n           accept=\".xlsx, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\"/>\n    <Button type=\"success\" icon=\"md-arrow-round-down\" @click=\"btnClick\">{{btnName}}</Button>\n  </span>\n</template>\n\n<script>\nimport XLSX from 'xlsx'\n\nexport default {\n  name: \"inputExcel\",\n  props: {\n    btnName: String,\n    default: \"选择excel文件\"\n  },\n  data() {\n    return {\n      isShow: true\n    }\n  },\n  methods: {\n    btnClick() {\n\n      if (this.isShow === false) {\n        this.isShow = true\n        setTimeout(this.querry, 150)\n      } else {\n        this.querry()\n      }\n\n    },\n\n    querry() {\n\n      document.querySelector(\".input-file\").click();\n    },\n    exportData(event) {\n\n      if (!event.currentTarget.files.length) {\n        return;\n      }\n      const that = this;\n      // 拿取文件对象\n      var f = event.currentTarget.files[0];\n      // 用FileReader来读取\n      var reader = new FileReader();\n      // 重写FileReader上的readAsBinaryString方法\n      FileReader.prototype.readAsBinaryString = function (f) {\n        var binary = \"\";\n        var wb; // 读取完成的数据\n        var outdata; // 你需要的数据\n        var reader = new FileReader();\n        reader.onload = function (e) {\n          // 读取成Uint8Array，再转换为Unicode编码（Unicode占两个字节）\n          var bytes = new Uint8Array(reader.result);\n          var length = bytes.byteLength;\n          for (var i = 0; i < length; i++) {\n            binary += String.fromCharCode(bytes[i]);\n          }\n          // 接下来就是xlsx了，具体可看api\n          wb = XLSX.read(binary, {\n            type: \"binary\"\n          });\n          outdata = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);\n          // 自定义方法向父组件传递数据\n          that.$emit(\"getResult\", outdata);\n        };\n        reader.readAsArrayBuffer(f);\n      };\n      reader.readAsBinaryString(f);\n      this.isShow = false\n    }\n  }\n}\n</script>\n\n<style scoped>\n.input-file {\n  display: none;\n}\n</style>\n"]}]}