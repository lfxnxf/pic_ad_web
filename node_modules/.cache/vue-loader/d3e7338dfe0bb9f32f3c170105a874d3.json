{"remainingRequest":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhang/canteen_manage/src/views/staff-management/dining-staff/components/form.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhang/canteen_manage/src/views/staff-management/dining-staff/components/form.vue","mtime":1644998572171},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBfIGZyb20gJ3VuZGVyc2NvcmUnOwppbXBvcnQgZGVwYXJ0bWVudFRyZWUgZnJvbSAnQC9jb21wb25lbnRzL2RlcGFydG1lbnQtdHJlZSc7CmltcG9ydCBJbnB1dEV4Y2VsIGZyb20gIkB2aWV3cy9jb21wb25lbnRzL2lucHV0LWV4Y2VsL2lucHV0RXhjZWwiOwppbXBvcnQgZXhjZWwgZnJvbSAiQC9saWJzL2V4Y2VsIjsKaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQtdGltZXpvbmUiOwppbXBvcnQge2J1aWxkQ2hpbGREZXBhcnRtZW50QXJyYXl9IGZyb20gIkAvbGlicy91dGlsIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnc2VhcmNoRm9ybScsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBmb3JtOiB7CiAgICAgICAga2V5OiAnJywKICAgICAgICBkZXBhcnRtZW50czogW10sCiAgICAgICAgcm9sZV9pZHM6IFtdLAogICAgICAgIHN0YXR1czogJycKICAgICAgfSwKICAgICAgYnRuTmFtZTogJ+WvvOWFpUV4Y2VsJywKICAgIH07CiAgfSwKCiAgY29tcG9uZW50czoge0lucHV0RXhjZWwsIGRlcGFydG1lbnRUcmVlIH0sCgogIGNvbXB1dGVkOiB7CiAgICByZXN1bHRGb3JtKCl7CiAgICAgIGxldCBkYXRhID0gewogICAgICAgIGtleTogdGhpcy5mb3JtLmtleSwKICAgICAgICBkZXBhcnRtZW50czogdGhpcy5mb3JtLmRlcGFydG1lbnRzWzBdPT0nLTEnPyAnJzp0aGlzLmZvcm0uZGVwYXJ0bWVudHMudG9TdHJpbmcoKSwKICAgICAgICByb2xlczogdGhpcy5mb3JtLnJvbGVfaWRzWzBdPT0nLTEnPyAnJzp0aGlzLmZvcm0ucm9sZV9pZHMudG9TdHJpbmcoKSwKICAgICAgICBzdGF0dXM6IHRoaXMuZm9ybS5zdGF0dXM9PSctMSc/Jyc6dGhpcy5mb3JtLnN0YXR1cywKICAgICAgfQogICAgICByZXR1cm4gZGF0YTsKICAgIH0sCiAgICBjdXJyZW50T3JnSWQoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmN1ck9yZ0lkOwogICAgfSwKICAgIHNlc3Npb25JZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIudG9rZW47CiAgICB9LAogICAgZW1wVXNlckNvZGUoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmVtcFVzZXJDb2RlOwogICAgfSwKICAgIGN1cnJlbnRNZXJjaGFudElkKCl7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmN1ck1lcmNoYW50SWQ7CiAgICB9LAogICAgY3VycmVudE1lcmNoYW50TmFtZSgpewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUudXNlci5jdXJNZXJjaGFudE5hbWU7CiAgICB9LAogICAgcm9sZUxpc3QoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5yb2xlLnJvbGVMaXN0LnJlc3VsdDsKICAgIH0sCiAgICBzZWxlY3RlZFVzZXJMaXN0KCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUudXNlci5zZWxlY3RlZFVzZXJMaXN0OwogICAgfQogIH0sCgogIG1ldGhvZHM6IHsKICAgIC8vIOa3u+WKoOmDqOmXqOS6uuWRmAogICAgYXN5bmMgYWRkRGVwYXJ0bWVudFVzZXIoKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0RGVwYXJ0bWVudE1vZGFsJywgdHJ1ZSk7CiAgICB9LAoKICAgIC8vIOa3u+WKoOaWsOWwsemkkOS6uuWRmAogICAgYXN5bmMgYWRkRW1wbG95ZWVVc2VyKCkgewogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldEVtcGxveWVlTW9kYWwnLCB0cnVlKTsKICAgICAgLy8gdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRVc2VyTW9kYWwnLCB0cnVlKTsKICAgIH0sCgogICAgLy8g5re75Yqg5paw5bCx6aSQ5Lq65ZGYCiAgICBhc3luYyBhZGRPdGhlclVzZXIoKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0T3RoZXJVc2VyTW9kYWwnLCB0cnVlKTsKICAgIH0sCgogICAgLy/mn6Xor6LkvIHkuJrlkZjlt6Xkv6Hmga8KICAgIHF1ZXJ5RW1wbG95ZWVMaXN0OiBhc3luYyBmdW5jdGlvbihkZXBhcnRtZW50SWQsIGtleSwgcGFnZSwgcGFnZV9zaXplKSB7CiAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgc2Vzc2lvbmlkOiB0aGlzLnNlc3Npb25JZCwKICAgICAgICBvcmdfaWQ6IHRoaXMuY3VycmVudE9yZ0lkLAogICAgICAgIHVzZXJjb2RlOiB0aGlzLmVtcFVzZXJDb2RlLAogICAgICAgIGRlcGFydG1lbnRfaWQ6IGRlcGFydG1lbnRJZCwKICAgICAgICBxdWVyeToga2V5LAogICAgICAgIGxpbWl0OiBwYWdlX3NpemUgfHwgdGhpcy4kcGFyZW50LnBhZ2Vfc2l6ZQogICAgICB9OwoKICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2VtcGxveWVlTGlzdCcsIHBhcmFtcyk7CiAgICB9LAoKICAgIC8vIOaJuemHj+S4i+WNlQogICAgc3VibWl0QmF0Y2goKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0U3VibWl0QmF0Y2hNb2RhbCcsIHRydWUpOwogICAgfSwKICAgIC8vIOaJuemHj+WFheWAvAogICAgc3VibWl0RGVwb3NpdCgpewogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldEJhdGNoRGVwb3NpdE1vZGFsJywgdHJ1ZSk7CiAgICB9LAogICAgLy/ngrnlh7vpgInmi6npg6jpl6gv5Lq65ZGY57G75Z6LCiAgICBoYW5kbGVTZWxlY3QodmFsLCBuYW1lKXsKICAgICAgaWYoXy5pbmRleE9mKHZhbCwgJy0xJykgIT0gLTEpewogICAgICAgIHRoaXMuZm9ybVtuYW1lXSA9IFsnLTEnXTsKICAgICAgfQogICAgfSwKICAgIC8v6I635Y+WCiAgICBnZXREZXBhcnRtZW50cyh2YWwpewogICAgICB0aGlzLmZvcm0uZGVwYXJ0bWVudHMgPSB2YWw7CiAgICB9LAoKICAgIC8vIOafpeivokV4Y2Vs5a+85YWl55qE5YWo6YOo5bCx6aSQ5ZGY5belCiAgICBxdWVyeUVtcFVzZXJMaXN0OiBhc3luYyBmdW5jdGlvbih1c2VyQ29kZUFycikgewogICAgICBsZXQgcGFyYW1zID0gewogICAgICAgIG1lcmNoYW50X2lkOiB0aGlzLmN1cnJlbnRNZXJjaGFudElkLAogICAgICAgIHVzZXJzOiB1c2VyQ29kZUFyci50b1N0cmluZygpLAogICAgICAgIC8vIHBhZ2U6IHBhZ2UgfHwgMSwKICAgICAgICAvLyBwYWdlX3NpemU6IHBhZ2Vfc2l6ZSB8fCB0aGlzLiRwYXJlbnQucGFnZV9zaXplLAoKICAgICAgfTsKICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3N0YWZmTGlzdCcsIHBhcmFtcyk7CiAgICB9LAoKICAgIGdldEV4Y2VsRGF0YShkYXRhKSB7CiAgICAgIC8v5aSE55CG5L2g55qE5pWw5o2uCiAgICAgIGNvbnNvbGUubG9nKCdnZXRFeGNlbERhdGEtLS0+Pj4nLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgIGxldCBjdXJyZW50ID0gdGhpczsKICAgICAgdGhpcy4kTWVzc2FnZS5zdWNjZXNzKCflr7zlhaXmlbDmja7miJDlip8nKTsKCiAgICAgIGxldCB1c2VyQ29kZUFyciA9IF8ucGx1Y2soZGF0YSwgJ+S6uuWRmOi0puWPtycpOwoKICAgICAgdGhpcy5xdWVyeUVtcFVzZXJMaXN0KHVzZXJDb2RlQXJyKTsKCiAgICAgIC8vIGRhdGEubWFwKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgpIHsKICAgICAgLy8KICAgICAgLy8gfSk7CiAgICAgIC8vIHRoaXMudGVzdF9jb250ZW50X2Nsb25lID0gdGhpcy5jbG9uZSh0aGlzLnRlc3RfY29udGVudCkKICAgIH0sCgoKICB9LAoKCgp9Cg=="},{"version":3,"sources":["form.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;;;;AAIA","file":"form.vue","sourceRoot":"src/views/staff-management/dining-staff/components","sourcesContent":["<!--  -->\n<template>\n  <div class=\"card\">\n    <Form inline ref=\"form\" :model=\"form\" label-colon>\n      <div>\n        <FormItem>\n          <Button type='success' icon=\"md-add\" @click=\"addDepartmentUser()\">添加用户</Button>\n        </FormItem>\n        <!-- <FormItem>\n          <Button type='success' icon=\"md-add\" @click=\"addEmployeeUser()\">按用户添加</Button>\n        </FormItem>\n        <FormItem>\n          <Button type='success' icon=\"md-add\" @click=\"addOtherUser()\">添加其他人员</Button>\n        </FormItem> -->\n\n<!--        <FormItem>-->\n<!--          <Button type='success' icon=\"md-done-all\" @click=\"submitBatch\">批量下单</Button>-->\n<!--        </FormItem>-->\n        <FormItem>\n          <Button type='success' icon=\"md-done-all\" @click=\"submitDeposit\">批量充值</Button>\n        </FormItem>\n        <FormItem>\n          <Button class=\"pull-right\" icon=\"md-arrow-round-up\" type='success'  @click=\"$parent.exportUser()\">导出就餐人员</Button>\n        </FormItem>\n      </div>\n      <FormItem>\n        <Input :style=\"{width: '280px'}\" clearable @keyup.enter.native=\"$parent.query()\" v-model=\"form.key\" placeholder=\"用户姓名/手机号/就餐卡号等\"/>\n        <Input type=\"text\" v-show=\"false\" style=\"width: 1px;\"/>\n      </FormItem>\n      <FormItem>\n        <Select placeholder=\"选择人员类型\" @keyup.enter.native=\"$parent.query()\" v-model=\"form.role_ids\" multiple\n                @on-change=\"handleSelect(form.role_ids,'role_ids')\" style=\"min-width:140px;\">\n          <Option value=\"-1\">全部人员类型</Option>\n          <Option\n            v-for=\"item in roleList\"\n            :disabled=\"form.role_ids=='-1'\"\n            :key=\"item.role_id\" :value=\"item.role_id\"\n            :label=\"item.name\">{{ item.name }}\n          </Option>\n        </Select>\n      </FormItem>\n      <FormItem class=\"departments_tree\">\n        <department-tree @formDepartments=\"getDepartments\"></department-tree>\n      </FormItem>\n      <FormItem>\n        <Select placeholder=\"选择人员状态\" @keyup.enter.native=\"$parent.query()\" v-model=\"form.status\" style=\"min-width:120px;\">\n          <Option value=\"-1\">全部状态</Option>\n          <Option value=\"1\">正常</Option>\n          <Option value=\"0\">已删除</Option>\n        </Select>\n      </FormItem>\n      <FormItem>\n        <Button type='primary' icon=\"md-search\" @click=\"$parent.query()\">查询</Button>\n      </FormItem>\n    </Form>\n  </div>\n</template>\n<script>\nimport _ from 'underscore';\nimport departmentTree from '@/components/department-tree';\nimport InputExcel from \"@views/components/input-excel/inputExcel\";\nimport excel from \"@/libs/excel\";\nimport moment from \"moment-timezone\";\nimport {buildChildDepartmentArray} from \"@/libs/util\";\n\nexport default {\n  name: 'searchForm',\n  data() {\n    return {\n      loading: false,\n      form: {\n        key: '',\n        departments: [],\n        role_ids: [],\n        status: ''\n      },\n      btnName: '导入Excel',\n    };\n  },\n\n  components: {InputExcel, departmentTree },\n\n  computed: {\n    resultForm(){\n      let data = {\n        key: this.form.key,\n        departments: this.form.departments[0]=='-1'? '':this.form.departments.toString(),\n        roles: this.form.role_ids[0]=='-1'? '':this.form.role_ids.toString(),\n        status: this.form.status=='-1'?'':this.form.status,\n      }\n      return data;\n    },\n    currentOrgId() {\n      return this.$store.state.user.curOrgId;\n    },\n    sessionId() {\n      return this.$store.state.user.token;\n    },\n    empUserCode() {\n      return this.$store.state.user.empUserCode;\n    },\n    currentMerchantId(){\n      return this.$store.state.user.curMerchantId;\n    },\n    currentMerchantName(){\n      return this.$store.state.user.curMerchantName;\n    },\n    roleList() {\n      return this.$store.state.role.roleList.result;\n    },\n    selectedUserList() {\n      return this.$store.state.user.selectedUserList;\n    }\n  },\n\n  methods: {\n    // 添加部门人员\n    async addDepartmentUser() {\n      this.$store.commit('setDepartmentModal', true);\n    },\n\n    // 添加新就餐人员\n    async addEmployeeUser() {\n      this.$store.commit('setEmployeeModal', true);\n      // this.$store.commit('setUserModal', true);\n    },\n\n    // 添加新就餐人员\n    async addOtherUser() {\n      this.$store.commit('setOtherUserModal', true);\n    },\n\n    //查询企业员工信息\n    queryEmployeeList: async function(departmentId, key, page, page_size) {\n      let params = {\n        sessionid: this.sessionId,\n        org_id: this.currentOrgId,\n        usercode: this.empUserCode,\n        department_id: departmentId,\n        query: key,\n        limit: page_size || this.$parent.page_size\n      };\n\n      await this.$store.dispatch('employeeList', params);\n    },\n\n    // 批量下单\n    submitBatch() {\n      this.$store.commit('setSubmitBatchModal', true);\n    },\n    // 批量充值\n    submitDeposit(){\n      this.$store.commit('setBatchDepositModal', true);\n    },\n    //点击选择部门/人员类型\n    handleSelect(val, name){\n      if(_.indexOf(val, '-1') != -1){\n        this.form[name] = ['-1'];\n      }\n    },\n    //获取\n    getDepartments(val){\n      this.form.departments = val;\n    },\n\n    // 查询Excel导入的全部就餐员工\n    queryEmpUserList: async function(userCodeArr) {\n      let params = {\n        merchant_id: this.currentMerchantId,\n        users: userCodeArr.toString(),\n        // page: page || 1,\n        // page_size: page_size || this.$parent.page_size,\n\n      };\n      await this.$store.dispatch('staffList', params);\n    },\n\n    getExcelData(data) {\n      //处理你的数据\n      console.log('getExcelData--->>>', JSON.stringify(data));\n      let current = this;\n      this.$Message.success('导入数据成功');\n\n      let userCodeArr = _.pluck(data, '人员账号');\n\n      this.queryEmpUserList(userCodeArr);\n\n      // data.map(function (value, index) {\n      //\n      // });\n      // this.test_content_clone = this.clone(this.test_content)\n    },\n\n\n  },\n\n\n\n}\n</script>\n<style lang='less' scoped>\n.card{\n  padding-bottom: 0 !important;\n  // min-height: 76px;\n  // max-height: 133px;\n}\n\n\n</style>\n"]}]}