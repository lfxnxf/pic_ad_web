{"remainingRequest":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhang/canteen_manage/src/views/platform/tree.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhang/canteen_manage/src/views/platform/tree.vue","mtime":1638355006796},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAiQC9hc3NldHMvbGF5dWkvbGF5dWkuanMiOwppbXBvcnQgXyBmcm9tICJ1bmRlcnNjb3JlIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJ0cmVlSXRlbSIsCiAgcHJvcHM6IHsgdHJlZTogQXJyYXksIHNlbGVjdGVkOiBCb29sZWFuIH0sCiAgZGF0YTogZnVuY3Rpb24oKXsKICAgIHJldHVybiB7CiAgICAgIGZvcm06ICcnLAogICAgICBsYXllcjogIiIsCiAgICAgIGN1ckl0ZW06IFtdLAogICAgICBpc1NlbDogdGhpcy5zZWxlY3RlZCwKICAgIH0KICB9LAoKICB3YXRjaDogewogICAgJ3NlbGVjdGVkJyA6IGZ1bmN0aW9uKHZhbCl7CiAgICAgIHRoaXMuaXNTZWwgPSB2YWw7CiAgICB9CiAgfSwKCiAgbW91bnRlZCgpIHsKICAgIGlmICh0aGlzLnRyZWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnRyZWUpIHsKICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICBsYXl1aS51c2UoWydmb3JtJywgJ2xheWVyJ10sIGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGF0LmZvcm0gPSBsYXl1aS5mb3JtOwogICAgICAgIHRoYXQubGF5ZXIgPSBsYXl1aS5sYXllcjsKICAgICAgfSk7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICB0b2dnbGU6IGZ1bmN0aW9uKGkpIHsKICAgICAgdGhpcy50cmVlW2ldLm9wZW4gPSAhdGhpcy50cmVlW2ldLm9wZW47CiAgICAgIHRoaXMuJHNldCh0aGlzLnRyZWUsIGksIHRoaXMudHJlZVtpXSk7CiAgICB9LAogICAgaXNGb2xkZXI6IGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgcmV0dXJuIGRhdGEuY2hpbGQgJiYgZGF0YS5jaGlsZC5sZW5ndGgKICAgIH0sCiAgICBjaGFuZ2VDaGVjayh2YWwpIHsKICAgICAgY29uc29sZS5sb2coInRyZWVJdGVtLmNoYW5nZUNoZWNrLS0tLWlzU2VsPj4+PiIgKyB0aGlzLmN1ckl0ZW1bMF0uc2VsKTsKICAgICAgLy8gdGhpcy5pc1NlbCA9IHRoaXMuY3VySXRlbVswXS5zZWw7CiAgICAgIHRoaXMuY2hhbmdlQ2hpbGQodGhpcy5jdXJJdGVtLCB0aGlzLmN1ckl0ZW1bMF0uc2VsKTsKICAgICAgY29uc29sZS5sb2coInRyZWVJdGVtLmNoYW5nZUNoZWNrLS0tLWN1cml0ZW0+Pj4+IiArIEpTT04uc3RyaW5naWZ5KHRoaXMuY3VySXRlbSkpOwogICAgICBjb25zb2xlLmxvZygidHJlZUl0ZW0uY2hhbmdlQ2hlY2stLS0tYWZ0ZXIgdHJlZT4+Pj4iICsgSlNPTi5zdHJpbmdpZnkodGhpcy50cmVlKSk7CiAgICAgIHRoaXMuJGZvcmNlVXBkYXRlKCk7Ly/lvLrliLbmm7TmlrAKCiAgICB9LAogICAgaGFuZGxlQ2hlY2soaXRlbSl7CiAgICAgIHRoaXMuY3VySXRlbS5zcGxpY2UoMCx0aGlzLmN1ckl0ZW0ubGVuZ3RoKTsvL+a4heepuuaVsOe7hAogICAgICB0aGlzLmN1ckl0ZW0ucHVzaChpdGVtKTsKICAgICAgY29uc29sZS5sb2coInRyZWVJdGVtLmhhbmRsZUNoZWNrLS0tLWl0ZW0+Pj4+IiArIEpTT04uc3RyaW5naWZ5KHRoaXMuY3VySXRlbSkpOwogICAgfSwKCiAgICBjaGFuZ2VDaGlsZChkYXRhLCBpc1NlbCl7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGRhdGFbaV1bJ3NlbCddID0gaXNTZWw7CiAgICAgICAgaWYgKGRhdGFbaV0uY2hpbGQubGVuZ3RoID4gMCkgewogICAgICAgICAgdGhpcy5jaGFuZ2VDaGlsZChkYXRhW2ldLmNoaWxkLCBpc1NlbCk7CiAgICAgICAgfQogICAgICB9CgogICAgfSwKCiAgfSwKCiAgY3JlYXRlZDogZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBfYWRkT3BlbihkYXRhKSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGRhdGFbaV1bJ29wZW4nXSA9IGZhbHNlOwogICAgICAgIGRhdGFbaV1bJ3NlbCddID0gZmFsc2U7CiAgICAgICAgaWYgKGRhdGFbaV0uY2hpbGQubGVuZ3RoID4gMCkgewogICAgICAgICAgX2FkZE9wZW4oZGF0YVtpXS5jaGlsZCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAodGhpcy50cmVlICE9PSB1bmRlZmluZWQgJiYgdGhpcy50cmVlKSB7CiAgICAgIF9hZGRPcGVuKHRoaXMudHJlZSk7CiAgICB9CiAgfSwKCgp9Cg=="},{"version":3,"sources":["tree.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAoBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA","file":"tree.vue","sourceRoot":"src/views/platform","sourcesContent":["<template>\n  <div>\n    <ul class=\"tree-box\" >\n      <li class=\"tree-item\" v-for='(v,i) in tree' :key=\"v.id\">\n        <div class=\"tree-info-box\">\n          <i  class=\"layui-icon\" :class=\"[ tree[i].open ? 'layui-icon-triangle-d' :'layui-icon-triangle-r']\" v-if=\"isFolder(v)\" @click=\"toggle(i)\"></i>\n          <i v-else  class=\"layui-icon\" style=\"padding:8px;\"></i>\n          <!-- <span :data-id=\"i\" class=\"title-name\" @click=\"changeCheck(i)\" >{{v.name}}</span> -->\n          <span @click=\"handleCheck(v)\" >\n            <Checkbox class=\"title-name\" v-model=\"v.sel\" :label=\"v.id\" @on-change=\"changeCheck\" >{{v.name}}+{{v.sel}}+{{v.id}}+{{isSel}}</Checkbox>\n          </span>\n\n        </div>\n        <treeItem v-bind:tree='v.child' :selected='v.sel' v-show=\"v.open\" style=\"margin-left: 20px;\"></treeItem>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport \"@/assets/layui/layui.js\";\nimport _ from \"underscore\";\nexport default {\n  name: \"treeItem\",\n  props: { tree: Array, selected: Boolean },\n  data: function(){\n    return {\n      form: '',\n      layer: \"\",\n      curItem: [],\n      isSel: this.selected,\n    }\n  },\n\n  watch: {\n    'selected' : function(val){\n      this.isSel = val;\n    }\n  },\n\n  mounted() {\n    if (this.tree !== undefined && this.tree) {\n      let that = this;\n      layui.use(['form', 'layer'], function () {\n        that.form = layui.form;\n        that.layer = layui.layer;\n      });\n    }\n  },\n  methods: {\n    toggle: function(i) {\n      this.tree[i].open = !this.tree[i].open;\n      this.$set(this.tree, i, this.tree[i]);\n    },\n    isFolder: function(data) {\n      return data.child && data.child.length\n    },\n    changeCheck(val) {\n      console.log(\"treeItem.changeCheck----isSel>>>>\" + this.curItem[0].sel);\n      // this.isSel = this.curItem[0].sel;\n      this.changeChild(this.curItem, this.curItem[0].sel);\n      console.log(\"treeItem.changeCheck----curitem>>>>\" + JSON.stringify(this.curItem));\n      console.log(\"treeItem.changeCheck----after tree>>>>\" + JSON.stringify(this.tree));\n      this.$forceUpdate();//强制更新\n\n    },\n    handleCheck(item){\n      this.curItem.splice(0,this.curItem.length);//清空数组\n      this.curItem.push(item);\n      console.log(\"treeItem.handleCheck----item>>>>\" + JSON.stringify(this.curItem));\n    },\n\n    changeChild(data, isSel){\n      for (let i = 0; i < data.length; i++) {\n        data[i]['sel'] = isSel;\n        if (data[i].child.length > 0) {\n          this.changeChild(data[i].child, isSel);\n        }\n      }\n\n    },\n\n  },\n\n  created: function() {\n    function _addOpen(data) {\n      for (let i = 0; i < data.length; i++) {\n        data[i]['open'] = false;\n        data[i]['sel'] = false;\n        if (data[i].child.length > 0) {\n          _addOpen(data[i].child);\n        }\n      }\n    }\n    if (this.tree !== undefined && this.tree) {\n      _addOpen(this.tree);\n    }\n  },\n\n\n}\n</script>\n<style scoped>\n@import \"../../assets/layui/css/tree.css\";\n@import \"../../assets/layui/css/layui.css\";\n</style>\n\n"]}]}