{"remainingRequest":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhang/canteen_manage/src/views/food-management/components/add-food-modal.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhang/canteen_manage/src/views/food-management/components/add-food-modal.vue","mtime":1638355006792},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNFZGl0OiBmYWxzZSwKICAgICAgZm9vZFN0YXR1czogdHJ1ZSwKICAgICAgdXBsb2FkVHlwZTogWydqcGcnLCdqcGVnJywncG5nJywnZ2l0J10sCiAgICAgIHByb2dyZXNzOiBmYWxzZSwKICAgICAgdXBsb2FkVXJsOiByZXF1aXJlKCdAL2Fzc2V0cy9pbWFnZXMvY3VwLnBuZycpLAogICAgICB1cGxvYWRUaXRsZTogdHJ1ZSwKICAgICAgdXBGaWxlTmFtZTogJycsCiAgICAgIHVwRmlsZVN0YXR1czogJycsCiAgICAgIGZvcm06IHsKICAgICAgICBnb29kc19uYW1lOiAnJywKICAgICAgICBkZXNjcmlwdGlvbjogJycsCiAgICAgICAgdGltZV90eXBlOiAnJywKICAgICAgICBwcmljZTogJycsCiAgICAgICAgZGVmYXVsdF9pbWFnZTogJycsCiAgICAgIH0KICAgIH07CiAgfSwKCiAgY29tcG9uZW50czoge30sCgogIGNvbXB1dGVkOiB7CiAgICBhZGRNb2RhbDp7CiAgICAgIGdldCgpewogICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5nb29kcy5hZGRNb2RhbDsKICAgICAgfSwKICAgICAgc2V0KHZhbCl7CiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRBZGRNb2RhbCcsIHZhbCkKICAgICAgfQogICAgfQogIH0sCgogIG1ldGhvZHM6IHsKICAgIG1vZGlmeUZvb2QoKXsKICAgICAgdGhpcy5pc0VkaXQgPSB0cnVlOwogICAgfSwKICAgIHVwbG9hZFByb2dyZXNzKGV2ZW50LCBmaWxlLCBmaWxlTGlzdCl7CiAgICAgIHRoaXMucHJvZ3Jlc3MgPSB0cnVlOwogICAgICBpZihmaWxlTGlzdC5sZW5ndGg+MSl7CiAgICAgICAgZmlsZUxpc3QgPSBmaWxlTGlzdC5zcGxpY2UoMCwxKTsKICAgICAgfQogICAgfSwKICAgIHVwbG9hZFN1Y2Nlc3MocmVzcG9uc2UsIGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIHRoaXMuZm9ybS5kZWZhdWx0X2ltYWdlID0gcmVzcG9uc2UudXJsOwogICAgICB0aGlzLnByb2dyZXNzID0gZmFsc2U7CiAgICAgIHRoaXMudXBsb2FkVGl0bGUgPSBmYWxzZTsKICAgIH0sCgogICAgdXBsb2FkRXJyb3IoZXJyb3IsIGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIGNvbnNvbGUubG9nKCJ1cGxvYWRlcnJvcj09PT4+PiIgKyBKU09OLnN0cmluZ2lmeShlcnJvcikpCiAgICAgIGNvbnNvbGUubG9nKCJ1cGxvYWRlcnJvcj09PWZpbGU+Pj4iICsgSlNPTi5zdHJpbmdpZnkoZmlsZSkpCiAgICB9LAoKICAgIGhhbmRsZUZvcm1hdEVycm9yKGZpbGUpIHsKICAgICAgdGhpcy4kTm90aWNlLndhcm5pbmcoewogICAgICAgIHRpdGxlOiAn5paH5Lu25qC85byP5LiN5q2j56GuJywKICAgICAgICBkZXNjOiAn5paH5Lu2ICcgKyBmaWxlLm5hbWUgKyAnIOagvOW8j+S4jeato+ehru+8jOivt+S4iuS8oEpQR++8jEpQRUfvvIxQTkfvvIxHSVTmlofku7bjgIInCiAgICAgIH0pOwogICAgfSwKCiAgICBleGNlZWRlZFNpemUoZmlsZSwgZmlsZUxpc3QpewogICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKCfor7fkuIrkvKDkuI3otoXov4c1TULnmoTlm77niYcnKTsKICAgIH0sCiAgICBoYW5kbGVTYXZlKCl7CiAgICAgIHRoaXMuZm9ybS5wcmljZSA9IHBhcnNlRmxvYXQodGhpcy5mb3JtLnByaWNlKS50b0ZpeGVkKDIpLnRvU3RyaW5nKCkucmVwbGFjZSgvXi0/XGQrL2csIG0gPT4gbS5yZXBsYWNlKC8oPz0oPyFcYikoXGR7M30pKyQpL2csICIsIikpCiAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgbWVyY2hhbnRfaWQ6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuY3VyTWVyY2hhbnRJZCwKICAgICAgICAuLi50aGlzLmZvcm0KICAgICAgfQogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ29vZHNBZGQnLCBwYXJhbXMpLnRoZW4ocmVzPT57CiAgICAgICAgaWYocmVzLnJldHVybl9jb2RlPT0wKXsKICAgICAgICAgIHRoaXMuJE1lc3NhZ2Uuc3VjY2Vzcygn5re75Yqg5oiQ5Yqf77yBJyk7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldEFkZE1vZGFsJywgZmFsc2UpOwogICAgICAgICAgbGV0IGFyZyA9IHsKICAgICAgICAgICAgbWVyY2hhbnRfaWQ6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuY3VyTWVyY2hhbnRJZCwKICAgICAgICAgICAgcGFnZTogMSwKICAgICAgICAgICAgcGFnZV9zaXplOiA1MAogICAgICAgICAgfTsKICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdnb29kc0xpc3QnLCBhcmcpOwogICAgICAgICAgdGhpcy5mb3JtID0ge307CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["add-food-modal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"add-food-modal.vue","sourceRoot":"src/views/food-management/components","sourcesContent":["<!--  -->\n<template>\n  <Modal class=\"detailsModal addModal\" v-model=\"addModal\" width=\"820px\" :footer-hide=\"true\" :closable=\"false\">\n    <div>\n      <div>\n        <div class=\"gray-bg text-center modal-title\">添加菜品</div>\n        <Row>\n          <Col span=\"17\">\n            <Row class=\"list\">\n\n              <Col span=\"5\" class=\"border-l\">\n                <span>菜品名称</span>\n              </Col>\n              <Col span=\"19\">\n                <Input v-model=\"form.goods_name\" placeholder=\"输入菜品名称\"/>\n              </Col>\n\n              <Col span=\"5\" class=\"border-l\">\n                <span>描述</span>\n              </Col>\n              <Col span=\"19\">\n                <Input v-model=\"form.description\" type=\"textarea\" :rows=\"3\" placeholder=\"输入菜品描述\" />\n              </Col>\n\n              <Col span=\"5\" class=\"border-l\">\n                <span>菜品类型</span>\n              </Col>\n              <Col span=\"7\">\n                <Select v-model=\"form.time_type\" placeholder=\"选择菜品类型\">\n                  <Option value=\"breakfast\">早餐</Option>\n                  <Option value=\"nooning\">午餐</Option>\n                  <Option value=\"dinner\">晚餐</Option>\n                </Select>\n              </Col>\n\n              <Col span=\"5\">\n                <span>售价</span>\n              </Col>\n              <Col span=\"7\">\n                <Input v-model=\"form.price\" type=\"number\" placeholder=\"输入菜品售价\"/>\n              </Col>\n\n\n              <Col span=\"5\" class=\"border-l\">\n                <span>备注</span>\n              </Col>\n              <Col span=\"19\">\n                <Input v-model=\"form.remark\" placeholder=\"输入菜品备注\"/>\n              </Col>\n            </Row>\n          </Col>\n          <Col span=\"7\" >\n            <div class=\"upload_wrapper\">\n              <Upload\n                :class=\"progress?'opcity':''\"\n                type=\"drag\"\n                :paste=\"true\"\n                :format=\"uploadType\"\n                :max-size=\"5120\"\n                :on-progress=\"uploadProgress\"\n                :on-success='uploadSuccess'\n                :on-error='uploadError'\n                :on-exceeded-size=\"exceededSize\"\n                name='file'\n                action=\"/upload\">\n                  <div class=\"upload-container\">\n                    <div class=\"bg\">\n                      <p class=\"cursor\">+</p>\n                      <img class=\"upload-img width-full\" v-show=\"!progress\" :src=\"form.default_image\" alt=\"\">\n                      <div class=\"mark\"></div>\n                      <p v-show=\"uploadTitle\" class=\"star text-center\">\n                        点击添加菜品图片\n                      </p>\n                    </div>\n                  </div>\n              </Upload>\n              <p class=\"req\">大小不超过5MB，推荐尺寸[212*212]<br/>格式支持JPG，JPEG，PNG，GIT</p>\n            </div>\n          </Col>\n        </Row>\n\n        <div class=\"gray-bg border-top-0\">\n          <Button type=\"primary\" icon=\"md-checkmark\" @click=\"handleSave\">确认</Button>\n        </div>\n      </div>\n    </div>\n  </Modal>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      isEdit: false,\n      foodStatus: true,\n      uploadType: ['jpg','jpeg','png','git'],\n      progress: false,\n      uploadUrl: require('@/assets/images/cup.png'),\n      uploadTitle: true,\n      upFileName: '',\n      upFileStatus: '',\n      form: {\n        goods_name: '',\n        description: '',\n        time_type: '',\n        price: '',\n        default_image: '',\n      }\n    };\n  },\n\n  components: {},\n\n  computed: {\n    addModal:{\n      get(){\n        return this.$store.state.goods.addModal;\n      },\n      set(val){\n        this.$store.commit('setAddModal', val)\n      }\n    }\n  },\n\n  methods: {\n    modifyFood(){\n      this.isEdit = true;\n    },\n    uploadProgress(event, file, fileList){\n      this.progress = true;\n      if(fileList.length>1){\n        fileList = fileList.splice(0,1);\n      }\n    },\n    uploadSuccess(response, file, fileList) {\n      this.form.default_image = response.url;\n      this.progress = false;\n      this.uploadTitle = false;\n    },\n\n    uploadError(error, file, fileList) {\n      console.log(\"uploaderror===>>>\" + JSON.stringify(error))\n      console.log(\"uploaderror===file>>>\" + JSON.stringify(file))\n    },\n\n    handleFormatError(file) {\n      this.$Notice.warning({\n        title: '文件格式不正确',\n        desc: '文件 ' + file.name + ' 格式不正确，请上传JPG，JPEG，PNG，GIT文件。'\n      });\n    },\n\n    exceededSize(file, fileList){\n      this.$Message.error('请上传不超过5MB的图片');\n    },\n    handleSave(){\n      this.form.price = parseFloat(this.form.price).toFixed(2).toString().replace(/^-?\\d+/g, m => m.replace(/(?=(?!\\b)(\\d{3})+$)/g, \",\"))\n      let params = {\n        merchant_id: this.$store.state.user.curMerchantId,\n        ...this.form\n      }\n      this.$store.dispatch('goodsAdd', params).then(res=>{\n        if(res.return_code==0){\n          this.$Message.success('添加成功！');\n          this.$store.commit('setAddModal', false);\n          let arg = {\n            merchant_id: this.$store.state.user.curMerchantId,\n            page: 1,\n            page_size: 50\n          };\n          this.$store.dispatch('goodsList', arg);\n          this.form = {};\n        }\n      });\n    }\n  }\n};\n</script>\n<style lang='less' scoped>\n  @import '../style';\n</style>\n"]}]}