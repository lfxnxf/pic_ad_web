{"remainingRequest":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhang/canteen_manage/src/views/setting/food-card-setting/components/edit-modal.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhang/canteen_manage/src/views/setting/food-card-setting/components/edit-modal.vue","mtime":1638355006801},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBfIGZyb20gInVuZGVyc2NvcmUiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBidG5Mb2FkaW5nOiBmYWxzZSwKICAgICAgZm9ybTogewogICAgICAgIGNhcmRfaWQ6ICcnLAogICAgICAgIGNhcmRfbm86ICcnLAogICAgICAgIHJvbGVfaWQ6IHVuZGVmaW5lZCwKICAgICAgICByb2xlX25hbWU6ICcnLAogICAgICAgIGNhcmRfdHlwZTogJycsCiAgICAgICAgY2FyZF90eXBlX2Rlc2M6ICcnLAogICAgICAgIGlzX2VuYWJsZTogJycKICAgICAgfSwKICAgICAgcnVsZUZvcm06IHsKICAgICAgICBjYXJkX25vOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5bCx6aSQ5Y2h5Y+3JywgdHJpZ2dlcjogJ2JsdXInIH0KICAgICAgICBdLAogICAgICAgIGNhcmRfdHlwZTogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+mAieaLqeWwsemkkOWNoeexu+WeiycsIHRyaWdnZXI6ICdjaGFuZ2UnIH0KICAgICAgICBdLAogICAgICAgIHJvbGVfaWQ6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6nlsLHppJDkurrlkZjnsbvlnosnLCB0cmlnZ2VyOiAnY2hhbmdlJywgdHlwZTogJ251bWJlcicgfQogICAgICAgIF0sCiAgICAgIH0KICAgIH07CiAgfSwKCiAgY29tcG9uZW50czoge30sCgogIGNvbXB1dGVkOiB7CiAgICBlZGl0TW9kYWw6ewogICAgICBnZXQoKXsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuY2FyZC5lZGl0TW9kYWw7CiAgICAgIH0sCiAgICAgIHNldCh2YWwpewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0RWRpdENhcmRNb2RhbCcsIHZhbCkKICAgICAgfQogICAgfSwKICAgIGN1cnJlbnREYXRhKCl7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5jYXJkLmN1cnJlbnREYXRhOwogICAgfSwKICAgIHJvbGVMaXN0KCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUucm9sZS5yb2xlTGlzdC5yZXN1bHQ7CiAgICB9LAoKICB9LAoKICBtZXRob2RzOiB7CiAgICBlZGl0Q2FyZDogYXN5bmMgZnVuY3Rpb24oKXsKICAgICAgdGhpcy4kcmVmcy5lZGl0TW9kYWwudmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICB0aGlzLmJ0bkxvYWRpbmcgPSB0cnVlOwogICAgICAgICAgbGV0IHBhcmFtcyA9IHsKICAgICAgICAgICAgY2FyZF9pZDogdGhpcy5jdXJyZW50RGF0YS5jYXJkX2lkLAogICAgICAgICAgICBjYXJkX25vOiB0aGlzLmZvcm0uY2FyZF9ubywKICAgICAgICAgICAgY2FyZF90eXBlOiB0aGlzLmZvcm0uY2FyZF90eXBlLAogICAgICAgICAgICByb2xlX2lkOiB0aGlzLmZvcm0ucm9sZV9pZCwKICAgICAgICAgICAgaXNfZW5hYmxlOiB0aGlzLmZvcm0uaXNfZW5hYmxlCiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnY2FyZEVkaXQnLCBwYXJhbXMpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgaWYgKHJlcy5yZXR1cm5fY29kZSA9PSAwKSB7CiAgICAgICAgICAgICAgIHRoaXMuYnRuTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuJE1lc3NhZ2Uuc3VjY2Vzcygn5L+u5pS55oiQ5Yqf77yBJykKICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnY2FyZExpc3QnLCB7CiAgICAgICAgICAgICAgICBtZXJjaGFudF9pZDogdGhpcy4kc3RvcmUuc3RhdGUudXNlci5jdXJNZXJjaGFudElkLAogICAgICAgICAgICAgICAgcGFnZV9zaXplOiB0aGlzLiRwYXJlbnQucGFnZV9zaXplCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRFZGl0Q2FyZE1vZGFsJywgZmFsc2UpOwogICAgICAgICAgICAgIHRoaXMuJHJlZnMuZWRpdE1vZGFsLnJlc2V0RmllbGRzKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLmNhdGNoKGVycj0+ewogICAgICAgICAgICAgdGhpcy5idG5Mb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgfSwKICB3YXRjaDp7CiAgICBlZGl0TW9kYWwodmFsKXsKICAgICAgaWYodmFsKXsKICAgICAgICB0aGlzLmZvcm0gPSB0aGlzLmN1cnJlbnREYXRhOwogICAgICAgIHRoaXMuc2VsZWN0SXRlbXMgPSB0aGlzLmN1cnJlbnREYXRhLnJvbGVfaWQ7CiAgICAgIH1lbHNlewogICAgICAgIHRoaXMuYnRuTG9hZGluZyA9IGZhbHNlOwogICAgICB9CiAgICB9CiAgfQp9Cgo="},{"version":3,"sources":["edit-modal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"edit-modal.vue","sourceRoot":"src/views/setting/food-card-setting/components","sourcesContent":["<!--  -->\n<template>\n  <Modal\n    v-model=\"editModal\"\n    title=\"修改就餐卡\"\n    :footer-hide=\"true\"\n    width=\"420px\">\n    <Form :model=\"form\" :label-width=\"110\" ref=\"editModal\" :rules=\"ruleForm\">\n      <FormItem label=\"卡号\" prop=\"card_no\">\n        <Input v-model=\"form.card_no\" style=\"width: 200px\" placeholder=\"请输入就餐卡号\" />\n      </FormItem>\n      <FormItem label=\"卡类型\" prop=\"card_type\">\n         <RadioGroup v-model=\"form.card_type\">\n          <Radio label=\"2\">储值卡</Radio>\n          <Radio label=\"1\">计次卡</Radio>\n        </RadioGroup>\n      </FormItem>\n      <FormItem v-show=\"form.card_type==1\" label=\"人员类型\" class=\"width-full\" prop=\"role_id\">\n        <Select placeholder=\"请选择就餐人员类型\" v-model=\"form.role_id\" style=\"width:200px\">\n          <Option v-for=\"item in roleList\" :key=\"item.role_id\" :value=\"item.role_id\" :label=\"item.name\">\n            <span>{{ item.name }}</span>\n          </Option>\n        </Select>\n      </FormItem>\n      <FormItem label=\"是否有效\">\n        <RadioGroup v-model=\"form.is_enable\">\n          <Radio label=\"1\">有效</Radio>\n          <Radio label=\"0\">无效</Radio>\n        </RadioGroup>\n      </FormItem>\n      <div class=\"text-center margin-bottom-20 margin-top-30\">\n        <Button class=\"margin-right-20\" @click=\"$store.commit('setEditCardModal', false)\">取消</Button>\n        <Button type=\"primary\" :loading=\"btnLoading\" @click=\"editCard\">确定</Button>\n      </div>\n    </Form>\n  </Modal>\n</template>\n\n<script>\nimport _ from \"underscore\";\nexport default {\n  data () {\n    return {\n      btnLoading: false,\n      form: {\n        card_id: '',\n        card_no: '',\n        role_id: undefined,\n        role_name: '',\n        card_type: '',\n        card_type_desc: '',\n        is_enable: ''\n      },\n      ruleForm: {\n        card_no: [\n          { required: true, message: '请输入就餐卡号', trigger: 'blur' }\n        ],\n        card_type: [\n          { required: true, message: '请选择就餐卡类型', trigger: 'change' }\n        ],\n        role_id: [\n          { required: true, message: '请选择就餐人员类型', trigger: 'change', type: 'number' }\n        ],\n      }\n    };\n  },\n\n  components: {},\n\n  computed: {\n    editModal:{\n      get(){\n        return this.$store.state.card.editModal;\n      },\n      set(val){\n        this.$store.commit('setEditCardModal', val)\n      }\n    },\n    currentData(){\n      return this.$store.state.card.currentData;\n    },\n    roleList() {\n      return this.$store.state.role.roleList.result;\n    },\n\n  },\n\n  methods: {\n    editCard: async function(){\n      this.$refs.editModal.validate((valid) => {\n        if (valid) {\n          this.btnLoading = true;\n          let params = {\n            card_id: this.currentData.card_id,\n            card_no: this.form.card_no,\n            card_type: this.form.card_type,\n            role_id: this.form.role_id,\n            is_enable: this.form.is_enable\n          }\n          this.$store.dispatch('cardEdit', params).then(res => {\n            if (res.return_code == 0) {\n               this.btnLoading = false;\n              this.$Message.success('修改成功！')\n              this.$store.dispatch('cardList', {\n                merchant_id: this.$store.state.user.curMerchantId,\n                page_size: this.$parent.page_size\n              });\n              this.$store.commit('setEditCardModal', false);\n              this.$refs.editModal.resetFields();\n            }\n          }).catch(err=>{\n             this.btnLoading = false;\n          });\n        }\n      });\n    },\n\n  },\n  watch:{\n    editModal(val){\n      if(val){\n        this.form = this.currentData;\n        this.selectItems = this.currentData.role_id;\n      }else{\n        this.btnLoading = false;\n      }\n    }\n  }\n}\n\n</script>\n<style lang='less' scoped>\n</style>\n"]}]}