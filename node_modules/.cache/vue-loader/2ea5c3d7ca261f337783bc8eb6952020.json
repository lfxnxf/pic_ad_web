{"remainingRequest":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhang/canteen_manage/src/views/statistics/stat-order/components/form.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhang/canteen_manage/src/views/statistics/stat-order/components/form.vue","mtime":1640594514671},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBfIGZyb20gJ3VuZGVyc2NvcmUnOwppbXBvcnQgbW9tZW50IGZyb20gIm1vbWVudC10aW1lem9uZSI7CmltcG9ydCB7YnVpbGRDaGlsZERlcGFydG1lbnRBcnJheSwgZG93bmxvYWRGaWxlfSBmcm9tICJAL2xpYnMvdXRpbCI7CmltcG9ydCBkZXBhcnRtZW50VHJlZSBmcm9tICdAL2NvbXBvbmVudHMvZGVwYXJ0bWVudC10cmVlJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdzZWFyY2hGb3JtJywKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZm9ybTogewogICAgICAgIGRhdGU6IFttb21lbnQoKS5mb3JtYXQoJ1lZWVktTU0tREQnKSwgbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREJyldLAogICAgICAgIHVuaXQ6ICdkYXknLAogICAgICAgIHN0YXJ0TW9udGg6IG1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTScpLAogICAgICAgIGVuZE1vbnRoOiBtb21lbnQoKS5mb3JtYXQoJ1lZWVktTU0nKSwKICAgICAgICBnb29kc19pZHM6IFtdLAogICAgICAgIHJvbGVfaWRzOiBbXSwKICAgICAgICBkZXBhcnRtZW50czogW10sCiAgICAgIH0sCiAgICAgIGV4cG9ydF9leGNlbF9wYXJhbXM6IHt9LAogICAgfTsKICB9LAoKICBjb21wb25lbnRzOiB7IGRlcGFydG1lbnRUcmVlIH0sCgogIGNvbXB1dGVkOiB7CiAgICBnb29kc0xpc3QoKXsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmdvb2RzLmdvb2RzTGlzdC5yZXN1bHQ7CiAgICB9LAogICAgcm9sZUxpc3QoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5yb2xlLnJvbGVMaXN0LnJlc3VsdDsKICAgIH0sCiAgICByZXN1bHRGb3JtKCl7CiAgICAgIGxldCBkYXRhID0gewogICAgICAgIHVuaXQ6IHRoaXMuZm9ybS51bml0LAogICAgICAgIGdvb2RzX2lkczogdGhpcy5mb3JtLmdvb2RzX2lkc1swXT09Jy0xJz8gJyc6dGhpcy5mb3JtLmdvb2RzX2lkcy50b1N0cmluZygpLAogICAgICAgIHN0YXJ0OiBtb21lbnQodGhpcy5mb3JtLmRhdGVbMF0pLmZvcm1hdCgnWVlZWS1NTS1ERCcpLAogICAgICAgIGVuZDogbW9tZW50KHRoaXMuZm9ybS5kYXRlWzFdKS5mb3JtYXQoJ1lZWVktTU0tREQnKSwKICAgICAgICByb2xlX2lkczogdGhpcy5mb3JtLnJvbGVfaWRzWzBdPT0nLTEnPyAnJzp0aGlzLmZvcm0ucm9sZV9pZHMudG9TdHJpbmcoKSwKICAgICAgICBkZXBhcnRtZW50czogdGhpcy5mb3JtLmRlcGFydG1lbnRzWzBdPT0nLTEnPyAnJzp0aGlzLmZvcm0uZGVwYXJ0bWVudHMudG9TdHJpbmcoKSwKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZm9ybS51bml0ID09ICdtb250aCcpewogICAgICAgIGRhdGEuc3RhcnQgPSBtb21lbnQodGhpcy5mb3JtLnN0YXJ0TW9udGgpLmZvcm1hdCgnWVlZWS1NTScpOwogICAgICAgIGRhdGEuZW5kID0gbW9tZW50KHRoaXMuZm9ybS5lbmRNb250aCkuZm9ybWF0KCdZWVlZLU1NJyk7CiAgICAgIH0KICAgICAgcmV0dXJuIGRhdGE7CiAgICB9LAoKICB9LAoKICBtZXRob2RzOiB7CgogICAgcXVlcnlTdGF0OiBhc3luYyBmdW5jdGlvbihwYWdlKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnVEFCTEVfTE9BRElORycsIHRydWUpOwogICAgICBsZXQgc3RhcnREYXRlID0gdGhpcy5yZXN1bHRGb3JtLnN0YXJ0IHx8ICcnOwogICAgICBsZXQgZW5kRGF0ZSA9IHRoaXMucmVzdWx0Rm9ybS5lbmQgfHwgJyc7CiAgICAgIGlmIChzdGFydERhdGUgPT0gJycgfHwgc3RhcnREYXRlID09ICdJbnZhbGlkIGRhdGUnIHx8IGVuZERhdGUgPT0gJycgfHwgZW5kRGF0ZSA9PSAnSW52YWxpZCBkYXRlJyl7CiAgICAgICAgdGhpcy4kTWVzc2FnZS5lcnJvcigi6K+36YCJ5oup5bCx6aSQ57uf6K6h5pel5pyf6LW35q2i77yBIik7CiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdUQUJMRV9MT0FESU5HJywgZmFsc2UpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLiRlbWl0KCdnZXREYXRlJywgdGhpcy5yZXN1bHRGb3JtKTsKICAgICAgLy8gLy8gdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRFbXBsb3llZUxpc3RMb2FkaW5nJywgdHJ1ZSk7CiAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgbWVyY2hhbnRfaWQ6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuY3VyTWVyY2hhbnRJZCwKICAgICAgICBwYWdlOiBwYWdlIHx8IDEsCiAgICAgICAgcGFnZV9zaXplOiB0aGlzLiRwYXJlbnQucGFnZV9zaXplLAogICAgICAgIC4uLnRoaXMucmVzdWx0Rm9ybQogICAgICB9OwogICAgICAvLyBjb25zb2xlLmxvZygicXVlcnlTdGF0PT09cGFyYW1zPj4+IiArIEpTT04uc3RyaW5naWZ5KHBhcmFtcykpOwogICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3N0YXRpc3RpY3NPcmRlcicsIHBhcmFtcyk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCJxdWVyeVN0YXQ9PT1yZXM+Pj4iICsgSlNPTi5zdHJpbmdpZnkocmVzKSk7CiAgICAgIHRoaXMuJHJlZnNbJ2Zvcm0nXS5yZXNldEZpZWxkcygpOwogICAgfSwKCiAgICBleHBvcnRPcmRlcjogYXN5bmMgZnVuY3Rpb24oKSB7CiAgICAgIGxldCBmaWxlTmFtZSA9ICflsLHppJDmiqXooagnOwogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ1RBQkxFX0xPQURJTkcnLCB0cnVlKTsKICAgICAgbGV0IHN0YXJ0RGF0ZSA9IHRoaXMucmVzdWx0Rm9ybS5zdGFydCB8fCAnJzsKICAgICAgbGV0IGVuZERhdGUgPSB0aGlzLnJlc3VsdEZvcm0uZW5kIHx8ICcnOwogICAgICBpZiAoc3RhcnREYXRlID09ICcnIHx8IHN0YXJ0RGF0ZSA9PSAnSW52YWxpZCBkYXRlJyB8fCBlbmREYXRlID09ICcnIHx8IGVuZERhdGUgPT0gJ0ludmFsaWQgZGF0ZScpewogICAgICAgIHRoaXMuJE1lc3NhZ2UuZXJyb3IoIuivt+mAieaLqeWwsemkkOe7n+iuoeaXpeacn+i1t+atou+8gSIpOwogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnVEFCTEVfTE9BRElORycsIGZhbHNlKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgLy8gdGhpcy4kZW1pdCgnZ2V0RGF0ZScsIHRoaXMucmVzdWx0Rm9ybSk7CiAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgbWVyY2hhbnRfaWQ6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuY3VyTWVyY2hhbnRJZCwKICAgICAgICAuLi50aGlzLnJlc3VsdEZvcm0KICAgICAgfTsKICAgICAgbGV0IHF1ZXJ5QXJyYXkgPSBwYXJhbXMuZGVwYXJ0bWVudHMgfHwgJyc7CiAgICAgIGlmIChxdWVyeUFycmF5ICE9PSAnJyl7CiAgICAgICAgbGV0IHN0cmluZ1Jlc3VsdCA9IHF1ZXJ5QXJyYXkuc3BsaXQoJywnKTsKICAgICAgICBsZXQgZGVwYXJ0QXJyYXkgPSBidWlsZENoaWxkRGVwYXJ0bWVudEFycmF5KHN0cmluZ1Jlc3VsdCx0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmRlcGFydG1lbnRMaXN0KTsKICAgICAgICBsZXQgYXJyYXlSZXN1bHQgPSBkZXBhcnRBcnJheS5qb2luKCcsJyk7CiAgICAgICAgcGFyYW1zLmRlcGFydG1lbnRzID0gYXJyYXlSZXN1bHQ7CiAgICAgIH0KICAgICAgbGV0IHJlcyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdzdGF0aXN0aWNzT3JkZXJFeHBvcnQnLCBwYXJhbXMpOwogICAgICBpZiAocmVzLnJldHVybl9jb2RlID09IDApewogICAgICAgIGxldCBmaWxlVXJsID0gcmVzLmRhdGEudXJsOwogICAgICAgIGRvd25sb2FkRmlsZShmaWxlVXJsLCBmaWxlTmFtZSk7CiAgICAgIH0KICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdUQUJMRV9MT0FESU5HJywgZmFsc2UpOwogICAgfSwKCiAgICAvL+aVsOaNruWvvOWHugogICAgbGlzdFJlc3VsdEV4cG9ydDogYXN5bmMgZnVuY3Rpb24ocGFnZVNpemUpIHsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdUQUJMRV9MT0FESU5HJywgdHJ1ZSk7CiAgICAgIGxldCBzdGFydERhdGUgPSB0aGlzLnJlc3VsdEZvcm0uc3RhcnRfZGF0ZSB8fCAnJzsKICAgICAgbGV0IGVuZERhdGUgPSB0aGlzLnJlc3VsdEZvcm0uZW5kX2RhdGUgfHwgJyc7CiAgICAgIGlmIChzdGFydERhdGUgPT0gJycgfHwgc3RhcnREYXRlID09ICdJbnZhbGlkIGRhdGUnIHx8IGVuZERhdGUgPT0gJycgfHwgZW5kRGF0ZSA9PSAnSW52YWxpZCBkYXRlJyl7CiAgICAgICAgdGhpcy4kTWVzc2FnZS5lcnJvcigi6K+36YCJ5oup5bCx6aSQ5pel5pyf6LW35q2i77yBIik7CiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdUQUJMRV9MT0FESU5HJywgdHJ1ZSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBsZXQgbWF4UGFnZVNpemUgPSBwYWdlU2l6ZSA/IHBhZ2VTaXplIDogdGhpcy4kcGFyZW50LnBhZ2Vfc2l6ZTsKICAgICAgbGV0IHBhcmFtcyA9IHsKICAgICAgICBtZXJjaGFudF9pZDogdGhpcy4kc3RvcmUuc3RhdGUudXNlci5jdXJNZXJjaGFudElkLAogICAgICAgIHBhZ2U6IDEsCiAgICAgICAgcGFnZV9zaXplOiBtYXhQYWdlU2l6ZSwKICAgICAgICAuLi50aGlzLnJlc3VsdEZvcm0KICAgICAgfTsKCiAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnb3JkZXJMaXN0RXhwb3J0JywgcGFyYW1zKTsKICAgIH0sCgogICAgLy/lpJrpgIlzZWxlY3QKICAgIGhhbmRsZVNlbGVjdCh2YWwsIG5hbWUpewogICAgICBpZihfLmluZGV4T2YodmFsLCAnLTEnKSAhPSAtMSl7CiAgICAgICAgdGhpcy5mb3JtW25hbWVdID0gWyctMSddOwogICAgICB9CiAgICB9LAoKCiAgICBnZXREZXBhcnRtZW50cyh2YWwpewogICAgICB0aGlzLmZvcm0uZGVwYXJ0bWVudHMgPSB2YWw7CiAgICB9LAoKICAgIC8v5p+l6K+i6KeS6ImyCiAgICBxdWVyeVJvbGVMaXN0OiBhc3luYyBmdW5jdGlvbigpIHsKICAgICAgbGV0IHBhcmFtcyA9IHsKICAgICAgICBtZXJjaGFudF9pZDogdGhpcy4kc3RvcmUuc3RhdGUudXNlci5jdXJNZXJjaGFudElkLAogICAgICAgIGlzX2VuYWJsZTogMSwKICAgICAgICBwYWdlOiAxLAogICAgICAgIHBhZ2Vfc2l6ZTogMTAwMDAKICAgICAgfTsKICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3JvbGVMaXN0JywgcGFyYW1zKTsKCiAgICB9LAoKICAgIHF1ZXJ5R29vZHM6IGZ1bmN0aW9uKCkgewogICAgICBsZXQgcGFyYW1zID0gewogICAgICAgIG1lcmNoYW50X2lkOiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmN1ck1lcmNoYW50SWQsCiAgICAgICAgaXNfZW5hYmxlOiAxLAogICAgICB9OwogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ29vZHNMaXN0JywgcGFyYW1zKTsKICAgIH0sCgogIH0sCiAgYXN5bmMgbW91bnRlZCgpIHsKICAgIHRoaXMucXVlcnlHb29kcygpOwogICAgdGhpcy5xdWVyeVJvbGVMaXN0KCk7CiAgICB0aGlzLnF1ZXJ5U3RhdCgpOwogIH0KfQo="},{"version":3,"sources":["form.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"form.vue","sourceRoot":"src/views/statistics/stat-order/components","sourcesContent":["<!-- 就餐统计数据 -->\n<template>\n  <div class=\"card\">\n    <Form inline ref=\"form\" :model=\"form\" label-colon>\n      <FormItem label=\"汇总方式\">\n        <RadioGroup v-model=\"form.unit\">\n          <Radio label=\"day\">按日期</Radio>\n          <Radio label=\"month\">按月</Radio>\n        </RadioGroup>\n      </FormItem>\n      <FormItem label=\"汇总日期起止\" v-if=\"form.unit == 'day'\">\n        <DatePicker @keyup.enter.native=\"queryStat()\" v-model=\"form.date\" type=\"daterange\" format=\"yyyy/MM/dd\" placeholder=\"汇总日期起止\" style=\"width: 200px\"></DatePicker>\n        <Input type=\"text\" v-show=\"false\" style=\"width: 1px;\"/>\n      </FormItem>\n      <FormItem label=\"汇总月份起止\" v-if=\"form.unit == 'month'\">\n        <DatePicker class=\"margin-right-5\" @keyup.enter.native=\"queryStat()\" v-model=\"form.startMonth\" type=\"month\" format=\"yyyy-MM\" placeholder=\"汇总月份起\" style=\"width:100px\"></DatePicker>-\n        <DatePicker @keyup.enter.native=\"queryStat()\" v-model=\"form.endMonth\" type=\"month\" format=\"yyyy-MM\" placeholder=\"汇总月份止\" style=\"width:100px\"></DatePicker>\n      </FormItem>\n      <FormItem>\n        <Select \n          v-model=\"form.goods_ids\"\n          placeholder=\"请选择餐种\" \n          @keyup.enter.native=\"queryStat()\"\n          multiple \n          @on-change=\"handleSelect(form.goods_ids,'goods_id')\" \n          style=\"min-width: 100px;\">\n          <Option value=\"-1\" >全部餐种</Option>\n          <Option v-for=\"item in goodsList\" :disabled=\"form.goods_id=='-1'\" :key=\"item.goods_id\" :value=\"item.goods_id\" :label=\"item.goods_name\">\n            {{ item.goods_name }}\n          </Option>\n        </Select>\n      </FormItem>\n      <FormItem>\n        <Select placeholder=\"人员类型\" @keyup.enter.native=\"queryStatistics()\" v-model=\"form.role_id\" multiple @on-change=\"handleSelect(form.role_id,'role_id')\" style=\"min-width: 100px;\">\n          <Option value=\"-1\" >全部人员类型</Option>\n          <Option v-for=\"item in roleList\" :disabled=\"form.role_id=='-1'\" :key=\"item.role_id\" :value=\"item.role_id\" :label=\"item.name\">\n            {{ item.name }}\n          </Option>\n        </Select>\n      </FormItem>\n      <FormItem class=\"departments_tree\">\n        <department-tree @formDepartments=\"getDepartments\"></department-tree>\n      </FormItem>\n      <FormItem>\n        <Button type='primary' icon=\"md-search\" @click=\"queryStat()\">查询</Button>\n        <Button class=\"margin-left-10\" type='primary' ghost icon=\"md-download\" @click=\"exportOrder\">导出EXCEL</Button>\n      </FormItem>\n\n    </Form>\n  </div>\n</template>\n<script>\nimport _ from 'underscore';\nimport moment from \"moment-timezone\";\nimport {buildChildDepartmentArray, downloadFile} from \"@/libs/util\";\nimport departmentTree from '@/components/department-tree';\nexport default {\n  name: 'searchForm',\n  data() {\n    return {\n      form: {\n        date: [moment().format('YYYY-MM-DD'), moment().format('YYYY-MM-DD')],\n        unit: 'day',\n        startMonth: moment().format('YYYY-MM'),\n        endMonth: moment().format('YYYY-MM'),\n        goods_ids: [],\n        role_ids: [],\n        departments: [],\n      },\n      export_excel_params: {},\n    };\n  },\n\n  components: { departmentTree },\n\n  computed: {\n    goodsList(){\n      return this.$store.state.goods.goodsList.result;\n    },\n    roleList() {\n      return this.$store.state.role.roleList.result;\n    },\n    resultForm(){\n      let data = {\n        unit: this.form.unit,\n        goods_ids: this.form.goods_ids[0]=='-1'? '':this.form.goods_ids.toString(),\n        start: moment(this.form.date[0]).format('YYYY-MM-DD'),\n        end: moment(this.form.date[1]).format('YYYY-MM-DD'),\n        role_ids: this.form.role_ids[0]=='-1'? '':this.form.role_ids.toString(),\n        departments: this.form.departments[0]=='-1'? '':this.form.departments.toString(),\n      }\n\n      if (this.form.unit == 'month'){\n        data.start = moment(this.form.startMonth).format('YYYY-MM');\n        data.end = moment(this.form.endMonth).format('YYYY-MM');\n      }\n      return data;\n    },\n\n  },\n\n  methods: {\n\n    queryStat: async function(page) {\n      this.$store.commit('TABLE_LOADING', true);\n      let startDate = this.resultForm.start || '';\n      let endDate = this.resultForm.end || '';\n      if (startDate == '' || startDate == 'Invalid date' || endDate == '' || endDate == 'Invalid date'){\n        this.$Message.error(\"请选择就餐统计日期起止！\");\n        this.$store.commit('TABLE_LOADING', false);\n        return;\n      }\n      this.$emit('getDate', this.resultForm);\n      // // this.$store.commit('setEmployeeListLoading', true);\n      let params = {\n        merchant_id: this.$store.state.user.curMerchantId,\n        page: page || 1,\n        page_size: this.$parent.page_size,\n        ...this.resultForm\n      };\n      // console.log(\"queryStat===params>>>\" + JSON.stringify(params));\n      let res = await this.$store.dispatch('statisticsOrder', params);\n      // console.log(\"queryStat===res>>>\" + JSON.stringify(res));\n      this.$refs['form'].resetFields();\n    },\n\n    exportOrder: async function() {\n      let fileName = '就餐报表';\n      this.$store.commit('TABLE_LOADING', true);\n      let startDate = this.resultForm.start || '';\n      let endDate = this.resultForm.end || '';\n      if (startDate == '' || startDate == 'Invalid date' || endDate == '' || endDate == 'Invalid date'){\n        this.$Message.error(\"请选择就餐统计日期起止！\");\n        this.$store.commit('TABLE_LOADING', false);\n        return;\n      }\n      // this.$emit('getDate', this.resultForm);\n      let params = {\n        merchant_id: this.$store.state.user.curMerchantId,\n        ...this.resultForm\n      };\n      let queryArray = params.departments || '';\n      if (queryArray !== ''){\n        let stringResult = queryArray.split(',');\n        let departArray = buildChildDepartmentArray(stringResult,this.$store.state.user.departmentList);\n        let arrayResult = departArray.join(',');\n        params.departments = arrayResult;\n      }\n      let res = await this.$store.dispatch('statisticsOrderExport', params);\n      if (res.return_code == 0){\n        let fileUrl = res.data.url;\n        downloadFile(fileUrl, fileName);\n      }\n      this.$store.commit('TABLE_LOADING', false);\n    },\n\n    //数据导出\n    listResultExport: async function(pageSize) {\n      this.$store.commit('TABLE_LOADING', true);\n      let startDate = this.resultForm.start_date || '';\n      let endDate = this.resultForm.end_date || '';\n      if (startDate == '' || startDate == 'Invalid date' || endDate == '' || endDate == 'Invalid date'){\n        this.$Message.error(\"请选择就餐日期起止！\");\n        this.$store.commit('TABLE_LOADING', true);\n        return;\n      }\n\n      let maxPageSize = pageSize ? pageSize : this.$parent.page_size;\n      let params = {\n        merchant_id: this.$store.state.user.curMerchantId,\n        page: 1,\n        page_size: maxPageSize,\n        ...this.resultForm\n      };\n\n      let res = await this.$store.dispatch('orderListExport', params);\n    },\n\n    //多选select\n    handleSelect(val, name){\n      if(_.indexOf(val, '-1') != -1){\n        this.form[name] = ['-1'];\n      }\n    },\n\n\n    getDepartments(val){\n      this.form.departments = val;\n    },\n\n    //查询角色\n    queryRoleList: async function() {\n      let params = {\n        merchant_id: this.$store.state.user.curMerchantId,\n        is_enable: 1,\n        page: 1,\n        page_size: 10000\n      };\n      await this.$store.dispatch('roleList', params);\n\n    },\n\n    queryGoods: function() {\n      let params = {\n        merchant_id: this.$store.state.user.curMerchantId,\n        is_enable: 1,\n      };\n      this.$store.dispatch('goodsList', params);\n    },\n\n  },\n  async mounted() {\n    this.queryGoods();\n    this.queryRoleList();\n    this.queryStat();\n  }\n}\n</script>\n<style lang='less' scoped>\n.card{\n  padding-bottom: 0 !important;\n  // min-height: 76px;\n  // max-height: 133px;\n}\n\n</style>\n"]}]}