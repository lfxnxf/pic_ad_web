{"remainingRequest":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhang/canteen_manage/src/views/staff-management/dining-staff/components/form.vue?vue&type=style&index=0&id=a20929e2&lang=less&scoped=true&","dependencies":[{"path":"/Users/zhang/canteen_manage/src/views/staff-management/dining-staff/components/form.vue","mtime":1639451801858},{"path":"/Users/zhang/canteen_manage/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5jYXJkewogIHBhZGRpbmctYm90dG9tOiAwICFpbXBvcnRhbnQ7CiAgLy8gbWluLWhlaWdodDogNzZweDsKICAvLyBtYXgtaGVpZ2h0OiAxMzNweDsKfQoKCg=="},{"version":3,"sources":["form.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0MA;AACA;AACA;AACA;AACA","file":"form.vue","sourceRoot":"src/views/staff-management/dining-staff/components","sourcesContent":["<!--  -->\n<template>\n  <div class=\"card\">\n    <Form inline ref=\"form\" :model=\"form\" label-colon>\n      <div>\n        <FormItem>\n          <Button type='success' icon=\"md-add\" @click=\"addDepartmentUser()\">添加用户</Button>\n        </FormItem>\n        <!-- <FormItem>\n          <Button type='success' icon=\"md-add\" @click=\"addEmployeeUser()\">按用户添加</Button>\n        </FormItem>\n        <FormItem>\n          <Button type='success' icon=\"md-add\" @click=\"addOtherUser()\">添加其他人员</Button>\n        </FormItem> -->\n\n        <FormItem>\n<!--          <Button type='success' icon=\"md-done-all\" :disabled=\"selectedUserList.length==0\" @click=\"submitBatch\">批量下单-->\n          <Button type='success' icon=\"md-done-all\" @click=\"submitBatch\">批量下单</Button>\n        </FormItem>\n        <FormItem>\n          <Button type='success' icon=\"md-done-all\" @click=\"submitDeposit\">批量充值</Button>\n        </FormItem>\n        <FormItem>\n          <Button class=\"pull-right\" icon=\"md-arrow-round-up\" type='success'  @click=\"$parent.exportUser()\">导出就餐人员</Button>\n        </FormItem>\n      </div>\n      <FormItem>\n        <Input :style=\"{width: '280px'}\" clearable @keyup.enter.native=\"$parent.query()\" v-model=\"form.key\" placeholder=\"用户姓名/手机号/就餐卡号等\"/>\n        <Input type=\"text\" v-show=\"false\" style=\"width: 1px;\"/>\n      </FormItem>\n      <FormItem>\n        <Select placeholder=\"选择人员类型\" @keyup.enter.native=\"$parent.query()\" v-model=\"form.role_ids\" multiple\n                @on-change=\"handleSelect(form.role_ids,'role_ids')\" style=\"min-width:140px;\">\n          <Option value=\"-1\">全部人员类型</Option>\n          <Option\n            v-for=\"item in roleList\"\n            :disabled=\"form.role_ids=='-1'\"\n            :key=\"item.role_id\" :value=\"item.role_id\"\n            :label=\"item.name\">{{ item.name }}\n          </Option>\n        </Select>\n      </FormItem>\n      <FormItem class=\"departments_tree\">\n        <department-tree @formDepartments=\"getDepartments\"></department-tree>\n      </FormItem>\n      <FormItem>\n        <Select placeholder=\"选择人员状态\" @keyup.enter.native=\"$parent.query()\" v-model=\"form.status\" style=\"min-width:120px;\">\n          <Option value=\"-1\">全部状态</Option>\n          <Option value=\"1\">正常</Option>\n          <Option value=\"0\">已删除</Option>\n        </Select>\n      </FormItem>\n      <FormItem>\n        <Button type='primary' icon=\"md-search\" @click=\"$parent.query()\">查询</Button>\n      </FormItem>\n    </Form>\n  </div>\n</template>\n<script>\nimport _ from 'underscore';\nimport departmentTree from '@/components/department-tree';\nimport InputExcel from \"@views/components/input-excel/inputExcel\";\nimport excel from \"@/libs/excel\";\nimport moment from \"moment-timezone\";\nimport {buildChildDepartmentArray} from \"@/libs/util\";\n\nexport default {\n  name: 'searchForm',\n  data() {\n    return {\n      loading: false,\n      form: {\n        key: '',\n        departments: [],\n        role_ids: [],\n        status: ''\n      },\n      btnName: '导入Excel',\n    };\n  },\n\n  components: {InputExcel, departmentTree },\n\n  computed: {\n    resultForm(){\n      let data = {\n        key: this.form.key,\n        departments: this.form.departments[0]=='-1'? '':this.form.departments.toString(),\n        roles: this.form.role_ids[0]=='-1'? '':this.form.role_ids.toString(),\n        status: this.form.status=='-1'?'':this.form.status,\n      }\n      return data;\n    },\n    currentOrgId() {\n      return this.$store.state.user.curOrgId;\n    },\n    sessionId() {\n      return this.$store.state.user.token;\n    },\n    empUserCode() {\n      return this.$store.state.user.empUserCode;\n    },\n    currentMerchantId(){\n      return this.$store.state.user.curMerchantId;\n    },\n    currentMerchantName(){\n      return this.$store.state.user.curMerchantName;\n    },\n    roleList() {\n      return this.$store.state.role.roleList.result;\n    },\n    selectedUserList() {\n      return this.$store.state.user.selectedUserList;\n    }\n  },\n\n  methods: {\n    // 添加部门人员\n    async addDepartmentUser() {\n      this.$store.commit('setDepartmentModal', true);\n    },\n\n    // 添加新就餐人员\n    async addEmployeeUser() {\n      this.$store.commit('setEmployeeModal', true);\n      // this.$store.commit('setUserModal', true);\n    },\n\n    // 添加新就餐人员\n    async addOtherUser() {\n      this.$store.commit('setOtherUserModal', true);\n    },\n\n    //查询企业员工信息\n    queryEmployeeList: async function(departmentId, key, page, page_size) {\n      let params = {\n        sessionid: this.sessionId,\n        org_id: this.currentOrgId,\n        usercode: this.empUserCode,\n        department_id: departmentId,\n        query: key,\n        limit: page_size || this.$parent.page_size\n      };\n\n      await this.$store.dispatch('employeeList', params);\n    },\n\n    // 批量下单\n    submitBatch() {\n      this.$store.commit('setSubmitBatchModal', true);\n    },\n    // 批量充值\n    submitDeposit(){\n      this.$store.commit('setBatchDepositModal', true);\n    },\n    //点击选择部门/人员类型\n    handleSelect(val, name){\n      if(_.indexOf(val, '-1') != -1){\n        this.form[name] = ['-1'];\n      }\n    },\n    //获取\n    getDepartments(val){\n      this.form.departments = val;\n    },\n\n    // 查询Excel导入的全部就餐员工\n    queryEmpUserList: async function(userCodeArr) {\n      let params = {\n        merchant_id: this.currentMerchantId,\n        users: userCodeArr.toString(),\n        // page: page || 1,\n        // page_size: page_size || this.$parent.page_size,\n\n      };\n      await this.$store.dispatch('staffList', params);\n    },\n\n    getExcelData(data) {\n      //处理你的数据\n      console.log('getExcelData--->>>', JSON.stringify(data));\n      let current = this;\n      this.$Message.success('导入数据成功');\n\n      let userCodeArr = _.pluck(data, '人员账号');\n\n      this.queryEmpUserList(userCodeArr);\n\n      // data.map(function (value, index) {\n      //\n      // });\n      // this.test_content_clone = this.clone(this.test_content)\n    },\n\n\n  },\n\n\n\n}\n</script>\n<style lang='less' scoped>\n.card{\n  padding-bottom: 0 !important;\n  // min-height: 76px;\n  // max-height: 133px;\n}\n\n\n</style>\n"]}]}