{"remainingRequest":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhang/canteen_manage/src/views/setting/food-management/components/modal.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhang/canteen_manage/src/views/setting/food-management/components/modal.vue","mtime":1646818151974},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhang/canteen_manage/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/canteen_manage/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNFZGl0OiBmYWxzZSwKICAgICAgZm9vZFN0YXR1czogdHJ1ZSwKICAgICAgdXBsb2FkVHlwZTogWydqcGcnLCdqcGVnJywncG5nJywnZ2l0J10sCiAgICAgIHByb2dyZXNzOiBmYWxzZSwKICAgICAgdXBsb2FkVXJsOiByZXF1aXJlKCdAYXNzZXRzL2ltYWdlcy9jdXAucG5nJyksCiAgICAgIHVwbG9hZFRpdGxlOiB0cnVlLAogICAgICBmb3JtOiB7CiAgICAgICAgZm9vZF9uYW1lOiAnJywKICAgICAgICBkZXNjOiAnJywKICAgICAgICBpc19lbmFibGU6ICcnLAogICAgICAgIGltZzogJycsCiAgICAgICAgY3JlYXRlX3RpbWU6ICcnLAogICAgICAgIHVwZGF0ZV90aW1lOiAnJwogICAgICB9CiAgICB9OwogIH0sCgogIGNvbXBvbmVudHM6IHt9LAoKICBjb21wdXRlZDogewogICAgZm9vZERldGFpbHNNb2RhbDp7CiAgICAgIGdldCgpewogICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5mb29kLmZvb2REZXRhaWxzTW9kYWw7CiAgICAgIH0sCiAgICAgIHNldCh2YWwpewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Rm9vZERldGFpbHNNb2RhbCcsIHZhbCkKICAgICAgfQogICAgfSwKICAgIGZvb2REZXRhaWwoKXsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmZvb2QuZm9vZERldGFpbDsKICAgIH0KICB9LAoKICBtZXRob2RzOiB7CiAgICBtb2RpZnlGb29kKCl7CiAgICAgIHRoaXMuaXNFZGl0ID0gdHJ1ZTsKICAgICAgdGhpcy5mb3JtID0gdGhpcy5mb29kRGV0YWlsOwogICAgICB0aGlzLmZvcm0uZGVzYyA9IHRoaXMuZm9vZERldGFpbC5kZXNjLnJlcGxhY2UoLzxbXj5dKz4vZywiIikucmVwbGFjZSgiJm5ic3A7IiwgIiAiKQogICAgICB0aGlzLmZvcm0uc3RhdHVzID0gdGhpcy5mb29kRGV0YWlsLmlzX2VuYWJsZSsnJzsKICAgICAgY29uc29sZS5sb2coJ+eCueWHu+e8lui+keaMiemSricsdGhpcy5mb3JtLmRlc2MpCgogICAgfSwKICAgIHVwbG9hZFByb2dyZXNzKGV2ZW50LCBmaWxlLCBmaWxlTGlzdCl7CiAgICAgIHRoaXMucHJvZ3Jlc3MgPSB0cnVlOwogICAgICBpZihmaWxlTGlzdC5sZW5ndGg+MSl7CiAgICAgICAgZmlsZUxpc3QgPSBmaWxlTGlzdC5zcGxpY2UoMCwxKTsKICAgICAgfQogICAgfSwKICAgIHVwbG9hZFN1Y2Nlc3MocmVzcG9uc2UsIGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIHRoaXMuZm9ybS5pbWcgPSByZXNwb25zZS51cmw7CiAgICAgIHRoaXMucHJvZ3Jlc3MgPSBmYWxzZTsKICAgICAgdGhpcy51cGxvYWRUaXRsZSA9IGZhbHNlOwogICAgfSwKCiAgICB1cGxvYWRFcnJvcihlcnJvciwgZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgdGhpcy4kTWVzc2FnZS5lcnJvcihlcnJvcikKICAgIH0sCiAgICBleGNlZWRlZFNpemUoZmlsZSwgZmlsZUxpc3QpewogICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKCfor7fkuIrkvKDkuI3otoXov4c1TULnmoTlm77niYcnKTsKICAgIH0sCiAgICBoYW5kbGVTYXZlKCl7CiAgICAgIHRoaXMuZm9ybS5wcmljZSA9IHBhcnNlRmxvYXQodGhpcy5mb3JtLnByaWNlKS50b0ZpeGVkKDIpLnRvU3RyaW5nKCkucmVwbGFjZSgvXi0/XGQrL2csIG0gPT4gbS5yZXBsYWNlKC8oPz0oPyFcYikoXGR7M30pKyQpL2csICIsIikpCiAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgZm9vZF9pZDogdGhpcy5mb29kRGV0YWlsLmZvb2RfaWQsCiAgICAgICAgLi4udGhpcy5mb3JtCiAgICAgIH0KICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2Zvb2RFZGl0JywgcGFyYW1zKS50aGVuKHJlcz0+ewogICAgICAgIGlmKHJlcy5yZXR1cm5fY29kZT09MCl7CiAgICAgICAgICB0aGlzLiRNZXNzYWdlLnN1Y2Nlc3MoJ+S/ruaUueaIkOWKn++8gScpOwogICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRGb29kRGV0YWlsc01vZGFsJywgZmFsc2UpOwogICAgICAgICAgbGV0IGFyZyA9IHsKICAgICAgICAgICAgbWVyY2hhbnRfaWQ6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuY3VyTWVyY2hhbnRJZCwKICAgICAgICAgICAgcGFnZTogMSwKICAgICAgICAgICAgcGFnZV9zaXplOiA1MAogICAgICAgICAgfTsKICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdmb29kTGlzdCcsIGFyZyk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICB9CiAgfSwKICB3YXRjaDogewogICAgZm9vZERldGFpbHNNb2RhbCh2YWwpewogICAgICBpZighdmFsKXsKICAgICAgICB0aGlzLmlzRWRpdCA9IGZhbHNlOwogICAgICAgIHRoaXMuZm9ybSA9IHt9CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["modal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"modal.vue","sourceRoot":"src/views/setting/food-management/components","sourcesContent":["<!--  -->\n<template>\n  <Modal class=\"foodDetailsModal detailsModal\" v-model=\"foodDetailsModal\" width=\"820px\" :footer-hide=\"true\" :mask-closable=\"false\">\n    <div>\n      <div>\n        <div v-if=\"isEdit\" class=\"gray-bg text-center modal-title green-color\">修改菜品信息</div>\n        <div v-else class=\"gray-bg\" >\n          <span class=\"font-blod padding-left-5 green-color\">{{foodDetail.food_name}}</span>\n          <!-- <i-switch  size=\"large\" class=\"pull-right\" v-model=\"foodStatus\">\n            <span slot=\"open\">正常</span>\n            <span slot=\"close\">下架</span>\n          </i-switch> -->\n        </div>\n        <Row>\n          <Col span=\"17\" class=\"border border-top-0\">\n            <Row v-if=\"isEdit\" class=\"name-row\">\n              <Col span=\"5\" >\n                <span class=\"font-weight\">菜品名称</span>\n              </Col>\n              <Col span=\"19\" class=\"border-l\">\n                <Input v-model=\"form.food_name\" placeholder=\"输入菜品名称\" />\n              </Col>\n            </Row>\n            <Row class=\"list\">\n              <Col span=\"5\" >\n                <span>菜品描述</span>\n              </Col>\n              <Col span=\"19\" style=\"min-height: 80px;\">\n                <Input v-if=\"isEdit\" v-model=\"form.desc\" type=\"textarea\" :rows=\"3\" placeholder=\"输入菜品描述\" />\n                <span v-else v-html=\"foodDetail.desc\"></span>\n              </Col>\n\n              <Col span=\"5\" >\n                <span>状态</span>\n              </Col>\n              <Col span=\"7\">\n                <RadioGroup v-if=\"isEdit\" v-model=\"form.is_enable\">\n                  <Radio label=\"1\">正常</Radio>\n                  <Radio label=\"0\">下架</Radio>\n                </RadioGroup>\n                <span v-else>{{foodDetail.is_enable==1?'正常':'下架'}}</span>\n              </Col>\n\n              <Col span=\"5\" class=\"border-l\">\n                <span>创建时间</span>\n              </Col>\n              <Col span=\"7\">\n                <Input v-if=\"isEdit\" v-model=\"form.create_time\" disabled />\n                <span v-else>{{foodDetail.create_time}}</span>\n              </Col>\n              <Col span=\"5\">\n                <span>更新时间</span>\n              </Col>\n              <Col span=\"19\">\n                <Input v-if=\"isEdit\" v-model=\"form.update_time\" disabled/>\n                <span v-else>{{foodDetail.update_time}}</span>\n              </Col>\n\n            </Row>\n          </Col>\n          <Col span=\"7\" >\n            <div v-if='isEdit' class=\"upload_wrapper\">\n              <Upload\n                :class=\"progress?'opcity':''\"\n                type=\"drag\"\n                :paste=\"true\"\n                :format=\"uploadType\"\n                :max-size=\"5120\"\n                :on-progress=\"uploadProgress\"\n                :on-success='uploadSuccess'\n                :on-error='uploadError'\n                :on-exceeded-size=\"exceededSize\"\n                name='file'\n                action=\"/upload\">\n                  <div class=\"upload-container\">\n                    <div class=\"bg\">\n                      <p class=\"cursor\">+</p>\n                      <img class=\"upload-img width-full\" v-show=\"!progress\" :src=\"form.img\" alt=\"\">\n                      <div class=\"mark\"></div>\n                      <p v-show=\"uploadTitle\" class=\"star\">\n                        <Icon type=\"ios-star\" class=\"margin-right-5\"/>\n                        默认图片\n                      </p>\n                    </div>\n                  </div>\n              </Upload>\n              <p class=\"req\">大小不超过5MB，推荐尺寸[212*212]<br/>格式支持JPG，JPEG，PNG，GIT</p>\n            </div>\n\n            <div v-else class=\"img-wrapper\">\n              <img class=\"width-full\" style=\"height: 211px;\" :src=\"foodDetail.img\" alt=\"\">\n            </div>\n          </Col>\n        </Row>\n\n        <div v-if=\"isEdit\" class=\"gray-bg border-top-0 text-center\">\n          <Button @click=\"isEdit=false\">取消</Button>\n          <Button type=\"primary\" class=\"margin-left-10\" icon=\"md-checkmark\" @click=\"handleSave\">保存修改</Button>\n        </div>\n        <div v-else class=\"gray-bg border-top-0 text-center\">\n          <Button type=\"primary\" icon=\"ios-build\" @click=\"modifyFood\">修改菜品信息</Button>\n        </div>\n      </div>\n    </div>\n  </Modal>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      isEdit: false,\n      foodStatus: true,\n      uploadType: ['jpg','jpeg','png','git'],\n      progress: false,\n      uploadUrl: require('@assets/images/cup.png'),\n      uploadTitle: true,\n      form: {\n        food_name: '',\n        desc: '',\n        is_enable: '',\n        img: '',\n        create_time: '',\n        update_time: ''\n      }\n    };\n  },\n\n  components: {},\n\n  computed: {\n    foodDetailsModal:{\n      get(){\n        return this.$store.state.food.foodDetailsModal;\n      },\n      set(val){\n        this.$store.commit('setFoodDetailsModal', val)\n      }\n    },\n    foodDetail(){\n      return this.$store.state.food.foodDetail;\n    }\n  },\n\n  methods: {\n    modifyFood(){\n      this.isEdit = true;\n      this.form = this.foodDetail;\n      this.form.desc = this.foodDetail.desc.replace(/<[^>]+>/g,\"\").replace(\"&nbsp;\", \" \")\n      this.form.status = this.foodDetail.is_enable+'';\n      console.log('点击编辑按钮',this.form.desc)\n\n    },\n    uploadProgress(event, file, fileList){\n      this.progress = true;\n      if(fileList.length>1){\n        fileList = fileList.splice(0,1);\n      }\n    },\n    uploadSuccess(response, file, fileList) {\n      this.form.img = response.url;\n      this.progress = false;\n      this.uploadTitle = false;\n    },\n\n    uploadError(error, file, fileList) {\n      this.$Message.error(error)\n    },\n    exceededSize(file, fileList){\n      this.$Message.error('请上传不超过5MB的图片');\n    },\n    handleSave(){\n      this.form.price = parseFloat(this.form.price).toFixed(2).toString().replace(/^-?\\d+/g, m => m.replace(/(?=(?!\\b)(\\d{3})+$)/g, \",\"))\n      let params = {\n        food_id: this.foodDetail.food_id,\n        ...this.form\n      }\n      this.$store.dispatch('foodEdit', params).then(res=>{\n        if(res.return_code==0){\n          this.$Message.success('修改成功！');\n          this.$store.commit('setFoodDetailsModal', false);\n          let arg = {\n            merchant_id: this.$store.state.user.curMerchantId,\n            page: 1,\n            page_size: 50\n          };\n          this.$store.dispatch('foodList', arg);\n        }\n      });\n\n    }\n  },\n  watch: {\n    foodDetailsModal(val){\n      if(!val){\n        this.isEdit = false;\n        this.form = {}\n      }\n    }\n  }\n};\n</script>\n<style lang='less' scoped>\n  @import '../style';\n  /deep/.ivu-modal-body{\n    padding-top: 45px !important;\n  }\n</style>\n"]}]}