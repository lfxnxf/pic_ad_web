{"remainingRequest":"/Users/zhang/工作/pic_ad/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhang/工作/pic_ad/src/views/staff-management/dining-staff/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhang/工作/pic_ad/src/views/staff-management/dining-staff/index.vue","mtime":1644998572174},{"path":"/Users/zhang/工作/pic_ad/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/工作/pic_ad/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhang/工作/pic_ad/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhang/工作/pic_ad/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7YnVpbGRDaGlsZERlcGFydG1lbnRBcnJheSwgZG93bmxvYWRGaWxlfSBmcm9tICJAL2xpYnMvdXRpbCI7CgppbXBvcnQgb3RoZXJ1c2VyTW9kYWwgZnJvbSAnLi9jb21wb25lbnRzL2FkZC1vdGhlcnVzZXItbW9kYWwnOwppbXBvcnQgZW1wbG95ZWVNb2RhbCBmcm9tICcuL2NvbXBvbmVudHMvYWRkLWVtcGxveWVlLW1vZGFsJzsKaW1wb3J0IHVzZXJNb2RhbCBmcm9tICcuL2NvbXBvbmVudHMvYWRkLXVzZXItbW9kYWwnOwppbXBvcnQgZGVwYXJ0bWVudE1vZGFsIGZyb20gJy4vY29tcG9uZW50cy9hZGQtZGVwYXJ0bWVudC1tb2RhbCc7CmltcG9ydCBzZWFyY2hGb3JtIGZyb20gJy4vY29tcG9uZW50cy9mb3JtJzsKaW1wb3J0IHNlYXJjaFRhYmxlIGZyb20gJy4vY29tcG9uZW50cy90YWJsZSc7CmltcG9ydCBlZGl0TW9kYWwgZnJvbSAnLi9jb21wb25lbnRzL2VkaXQtbW9kYWwnOwppbXBvcnQgc2VsTW9kYWwgZnJvbSAnLi9jb21wb25lbnRzL21vZGFsJzsKaW1wb3J0IHBlcnNvbmFsRGVwb3NpdE1vZGFsIGZyb20gJy4vY29tcG9uZW50cy9wZXJzb25hbC1kZXBvc2l0LW1vZGFsJzsKaW1wb3J0IGJhdGNoRGVwb3NpdE1vZGFsIGZyb20gJy4vY29tcG9uZW50cy9iYXRjaC1kZXBvc2l0LW1vZGFsJzsKaW1wb3J0IHdpdGhkcmF3U3VjTW9kYWwgZnJvbSAnLi9jb21wb25lbnRzL3dpdGhkcmF3LXN1Yy1tb2RhbCc7CmltcG9ydCBheGlvcyBmcm9tICdAL2xpYnMvYXBpLnBsYXRmb3JtLmpzJwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0RpbmluZ1N0YWZmJywKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgIHBhZ2Vfc2l6ZTogNTAsCiAgICAgIGlzX3NlbGVjdF9hbGw6IG51bGwsCiAgICAgIHVzZXJDb2RlRGF0YTogJycsCiAgICAgIGZyZXNoUmFuZG9tOiAwLAogICAgICB0cmVlRGF0YTogW10KICAgIH07CiAgfSwKCiAgY29tcG9uZW50czoge3NlYXJjaEZvcm0sIHNlYXJjaFRhYmxlLCBkZXBhcnRtZW50TW9kYWwsIGVtcGxveWVlTW9kYWwsIHVzZXJNb2RhbCwgZWRpdE1vZGFsLCBzZWxNb2RhbCwgcGVyc29uYWxEZXBvc2l0TW9kYWwsIGJhdGNoRGVwb3NpdE1vZGFsLG90aGVydXNlck1vZGFsLHdpdGhkcmF3U3VjTW9kYWx9LAoKICBjb21wdXRlZDogewogICAgdXNlckRhdGEoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLnVzZXJEYXRhOwogICAgfSwKICAgIGN1cnJlbnRNZXJjaGFudElkKCl7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmN1ck1lcmNoYW50SWQ7CiAgICB9LAoKICB9LAoKICBtZXRob2RzOiB7CiAgICBxdWVyeTogYXN5bmMgZnVuY3Rpb24ocGFnZSkgewogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ1RBQkxFX0xPQURJTkcnLCB0cnVlKTsKICAgICAgbGV0IHBhcmFtcyA9IHsKICAgICAgICAuLi50aGlzLiRyZWZzLkZvcm1RdWVyeS5yZXN1bHRGb3JtLAogICAgICAgIG1lcmNoYW50X2lkOiB0aGlzLmN1cnJlbnRNZXJjaGFudElkLAogICAgICAgIHBhZ2U6IHBhZ2UgfHwgMSwKICAgICAgICBwYWdlX3NpemU6IHRoaXMucGFnZV9zaXplCiAgICAgIH07CgogICAgICBsZXQgcXVlcnlBcnJheSA9IHBhcmFtcy5kZXBhcnRtZW50cyB8fCAnJzsKICAgICAgaWYgKHF1ZXJ5QXJyYXkgIT09ICcnKXsKICAgICAgICBsZXQgc3RyaW5nUmVzdWx0ID0gcXVlcnlBcnJheS5zcGxpdCgnLCcpOwogICAgICAgIGxldCBkZXBhcnRBcnJheSA9IGJ1aWxkQ2hpbGREZXBhcnRtZW50QXJyYXkoc3RyaW5nUmVzdWx0LHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuZGVwYXJ0bWVudExpc3QpOwogICAgICAgIGxldCBhcnJheVJlc3VsdCA9IGRlcGFydEFycmF5LmpvaW4oJywnKTsKICAgICAgICBwYXJhbXMuZGVwYXJ0bWVudHMgPSBhcnJheVJlc3VsdDsKICAgICAgfQogICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3N0YWZmTGlzdCcsIHBhcmFtcyk7CiAgICB9LAogICAgZXhwb3J0VXNlcjogYXN5bmMgZnVuY3Rpb24oKSB7CiAgICAgIGxldCBmaWxlTmFtZSA9ICflsLHppJDlkZjlt6Xkv6Hmga8nOwogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ1RBQkxFX0xPQURJTkcnLCB0cnVlKTsKICAgICAgbGV0IHBhcmFtcyA9IHsKICAgICAgICAuLi50aGlzLiRyZWZzLkZvcm1RdWVyeS5yZXN1bHRGb3JtLAogICAgICAgIG1lcmNoYW50X2lkOiB0aGlzLmN1cnJlbnRNZXJjaGFudElkLAogICAgICB9OwoKICAgICAgbGV0IHF1ZXJ5QXJyYXkgPSBwYXJhbXMuZGVwYXJ0bWVudHMgfHwgJyc7CiAgICAgIGlmIChxdWVyeUFycmF5ICE9PSAnJyl7CiAgICAgICAgbGV0IHN0cmluZ1Jlc3VsdCA9IHF1ZXJ5QXJyYXkuc3BsaXQoJywnKTsKICAgICAgICBsZXQgZGVwYXJ0QXJyYXkgPSBidWlsZENoaWxkRGVwYXJ0bWVudEFycmF5KHN0cmluZ1Jlc3VsdCx0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmRlcGFydG1lbnRMaXN0KTsKICAgICAgICBsZXQgYXJyYXlSZXN1bHQgPSBkZXBhcnRBcnJheS5qb2luKCcsJyk7CiAgICAgICAgcGFyYW1zLmRlcGFydG1lbnRzID0gYXJyYXlSZXN1bHQ7CiAgICAgIH0KCiAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZXhwb3J0VXNlckxpc3QnLCBwYXJhbXMpOwogICAgICBpZiAocmVzLnJldHVybl9jb2RlID09IDApewogICAgICAgIGxldCBmaWxlVXJsID0gcmVzLmRhdGEudXJsOwogICAgICAgIGRvd25sb2FkRmlsZShmaWxlVXJsLCBmaWxlTmFtZSk7CiAgICAgIH0KICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdUQUJMRV9MT0FESU5HJywgZmFsc2UpOwogICAgfSwKICAgIC8vIOWIhumhtQogICAgaGFuZGxlUGFnZURvd246IGZ1bmN0aW9uKGN1cnJlbnRQYWdlKSB7CiAgICAgIHRoaXMucXVlcnkoY3VycmVudFBhZ2UsIHRoaXMucGFnZV9zaXplKTsKICAgICAgdGhpcy4kcmVmcy5UYWJsZVF1ZXJ5LmluaXQoY3VycmVudFBhZ2UpOwogICAgfSwKICAgIC8v5p+l6K+i6KeS6ImyCiAgICBxdWVyeVJvbGVMaXN0OiBhc3luYyBmdW5jdGlvbigpIHsKICAgICAgbGV0IHBhcmFtcyA9IHsKICAgICAgICBtZXJjaGFudF9pZDogdGhpcy5jdXJyZW50TWVyY2hhbnRJZCwKICAgICAgICBpc19lbmFibGU6IDEsCiAgICAgICAgcGFnZTogMSwKICAgICAgICBwYWdlX3NpemU6IDEwMDAwCiAgICAgIH07CiAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdyb2xlTGlzdCcsIHBhcmFtcyk7CgogICAgfSwKCiAgICAvLyDojrflj5bppJDnp41saXN0CiAgICBxdWVyeUdvb2RzOiBhc3luYyBmdW5jdGlvbigpIHsKICAgICAgbGV0IHBhcmFtcyA9IHsKICAgICAgICBtZXJjaGFudF9pZDogdGhpcy5jdXJyZW50TWVyY2hhbnRJZCwKICAgICAgICBwYWdlOiAxLAogICAgICAgIHBhZ2Vfc2l6ZTogMTAwLAogICAgICAgIGlzX2VuYWJsZTogMQogICAgICB9OwogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ29vZHNMaXN0JywgcGFyYW1zKTsKCiAgICB9LAoKICAgIC8vIOafpeivouWFqOmDqOWwsemkkOWRmOW3pQogICAgcXVlcnlFbXBVc2VyTGlzdDogYXN5bmMgZnVuY3Rpb24ocGFnZSwgcGFnZV9zaXplKSB7CiAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgbWVyY2hhbnRfaWQ6IHRoaXMuY3VycmVudE1lcmNoYW50SWQsCiAgICAgICAgcGFnZTogcGFnZSB8fCAxLAogICAgICAgIHBhZ2Vfc2l6ZTogcGFnZV9zaXplIHx8IHRoaXMuJHBhcmVudC5wYWdlX3NpemUsCgogICAgICB9OwogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnc3RhZmZMaXN0JywgcGFyYW1zKTsKICAgIH0sCgogICAgc2V0U2VsZWN0aW9uKHJhbmRvbUtleSwgdXNlckNvZGVEYXRhKXsKICAgICAgaWYgKHJhbmRvbUtleSA+IDApewogICAgICAgIHRoaXMuaXNfc2VsZWN0X2FsbCA9IHJhbmRvbUtleTsKICAgICAgfQogICAgICB0aGlzLnVzZXJDb2RlRGF0YSA9IHVzZXJDb2RlRGF0YTsKICAgICAgdGhpcy5mcmVzaFJhbmRvbSA9IE1hdGgucmFuZG9tKCkqMTAwKzEwMDsKCiAgICB9LAogIH0sCgoKICBhc3luYyBtb3VudGVkKCkgewogICAgdGhpcy5xdWVyeSgpOwogICAgdGhpcy5xdWVyeVJvbGVMaXN0KCk7CiAgICB0aGlzLnF1ZXJ5R29vZHMoKTsKCiAgfSwKfQoK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA","file":"index.vue","sourceRoot":"src/views/staff-management/dining-staff","sourcesContent":["<!-- 就餐员工 -->\n<template>\n  <div>\n    <departmentModal></departmentModal>\n    <otheruserModal></otheruserModal>\n    <employee-modal></employee-modal>\n    <user-modal></user-modal>\n    <!-- 编辑用户modal -->\n    <edit-modal></edit-modal>\n    <!-- 选择下单modal -->\n    <sel-modal @selection=\"setSelection\"></sel-modal>\n    <!-- 个人充值/取现modal -->\n    <personal-deposit-modal @selection=\"setSelection\"></personal-deposit-modal>\n    <!-- 取现成功modal -->\n    <withdraw-suc-modal></withdraw-suc-modal>\n    <!-- 批量充值 -->\n    <batch-deposit-modal @selection=\"setSelection\"></batch-deposit-modal>\n    <div class=\"margin-bottom-10\">\n      <searchForm ref=\"FormQuery\" :treeData=\"treeData\"></searchForm>\n    </div>\n    <div class=\"card\">\n      <searchTable ref=\"TableQuery\" :selectAll=\"is_select_all\" :freshRandom=\"freshRandom\" :userCodeData=\"userCodeData\"></searchTable>\n    </div>\n    <Page class=\"page\" ref=\"pages\" :total=\"userData.total\" :page-size=\"page_size\" size=\"small\" show-total @on-change=\"handlePageDown\"></Page>\n  </div>\n</template>\n\n<script>\nimport {buildChildDepartmentArray, downloadFile} from \"@/libs/util\";\n\nimport otheruserModal from './components/add-otheruser-modal';\nimport employeeModal from './components/add-employee-modal';\nimport userModal from './components/add-user-modal';\nimport departmentModal from './components/add-department-modal';\nimport searchForm from './components/form';\nimport searchTable from './components/table';\nimport editModal from './components/edit-modal';\nimport selModal from './components/modal';\nimport personalDepositModal from './components/personal-deposit-modal';\nimport batchDepositModal from './components/batch-deposit-modal';\nimport withdrawSucModal from './components/withdraw-suc-modal';\nimport axios from '@/libs/api.platform.js'\nexport default {\n  name: 'DiningStaff',\n  data () {\n    return {\n      page_size: 50,\n      is_select_all: null,\n      userCodeData: '',\n      freshRandom: 0,\n      treeData: []\n    };\n  },\n\n  components: {searchForm, searchTable, departmentModal, employeeModal, userModal, editModal, selModal, personalDepositModal, batchDepositModal,otheruserModal,withdrawSucModal},\n\n  computed: {\n    userData() {\n      return this.$store.state.user.userData;\n    },\n    currentMerchantId(){\n      return this.$store.state.user.curMerchantId;\n    },\n\n  },\n\n  methods: {\n    query: async function(page) {\n      this.$store.commit('TABLE_LOADING', true);\n      let params = {\n        ...this.$refs.FormQuery.resultForm,\n        merchant_id: this.currentMerchantId,\n        page: page || 1,\n        page_size: this.page_size\n      };\n\n      let queryArray = params.departments || '';\n      if (queryArray !== ''){\n        let stringResult = queryArray.split(',');\n        let departArray = buildChildDepartmentArray(stringResult,this.$store.state.user.departmentList);\n        let arrayResult = departArray.join(',');\n        params.departments = arrayResult;\n      }\n      let res = await this.$store.dispatch('staffList', params);\n    },\n    exportUser: async function() {\n      let fileName = '就餐员工信息';\n      this.$store.commit('TABLE_LOADING', true);\n      let params = {\n        ...this.$refs.FormQuery.resultForm,\n        merchant_id: this.currentMerchantId,\n      };\n\n      let queryArray = params.departments || '';\n      if (queryArray !== ''){\n        let stringResult = queryArray.split(',');\n        let departArray = buildChildDepartmentArray(stringResult,this.$store.state.user.departmentList);\n        let arrayResult = departArray.join(',');\n        params.departments = arrayResult;\n      }\n\n      let res = await this.$store.dispatch('exportUserList', params);\n      if (res.return_code == 0){\n        let fileUrl = res.data.url;\n        downloadFile(fileUrl, fileName);\n      }\n      this.$store.commit('TABLE_LOADING', false);\n    },\n    // 分页\n    handlePageDown: function(currentPage) {\n      this.query(currentPage, this.page_size);\n      this.$refs.TableQuery.init(currentPage);\n    },\n    //查询角色\n    queryRoleList: async function() {\n      let params = {\n        merchant_id: this.currentMerchantId,\n        is_enable: 1,\n        page: 1,\n        page_size: 10000\n      };\n      await this.$store.dispatch('roleList', params);\n\n    },\n\n    // 获取餐种list\n    queryGoods: async function() {\n      let params = {\n        merchant_id: this.currentMerchantId,\n        page: 1,\n        page_size: 100,\n        is_enable: 1\n      };\n      await this.$store.dispatch('goodsList', params);\n\n    },\n\n    // 查询全部就餐员工\n    queryEmpUserList: async function(page, page_size) {\n      let params = {\n        merchant_id: this.currentMerchantId,\n        page: page || 1,\n        page_size: page_size || this.$parent.page_size,\n\n      };\n      await this.$store.dispatch('staffList', params);\n    },\n\n    setSelection(randomKey, userCodeData){\n      if (randomKey > 0){\n        this.is_select_all = randomKey;\n      }\n      this.userCodeData = userCodeData;\n      this.freshRandom = Math.random()*100+100;\n\n    },\n  },\n\n\n  async mounted() {\n    this.query();\n    this.queryRoleList();\n    this.queryGoods();\n\n  },\n}\n\n</script>\n<style lang='less' scoped>\n</style>\n"]}]}